var PageSupportBot=function(e){"use strict";function t(){}function n(e){return e()}function r(){return Object.create(null)}function s(e){e.forEach(n)}function i(e){return"function"==typeof e}function o(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function a(e,t){e.appendChild(t)}function l(e,t,n){e.insertBefore(t,n||null)}function u(e){e.parentNode.removeChild(e)}function c(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function p(e){return document.createElement(e)}function h(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function f(e){return document.createTextNode(e)}function d(){return f(" ")}function g(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function m(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function x(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function y(e,t){e.value=null==t?"":t}function w(e,t){for(let n=0;n<e.options.length;n+=1){const r=e.options[n];if(r.__value===t)return void(r.selected=!0)}e.selectedIndex=-1}function b(e,t,n){e.classList[n?"add":"remove"](t)}let k;function v(e){k=e}function A(){if(!k)throw new Error("Function called outside component initialization");return k}function E(){const e=A();return(t,n)=>{const r=e.$$.callbacks[t];if(r){const s=function(e,t,n=!1){const r=document.createEvent("CustomEvent");return r.initCustomEvent(e,n,!1,t),r}(t,n);r.slice().forEach((t=>{t.call(e,s)}))}}}const _=[],S=[],$=[],O=[],T=Promise.resolve();let M=!1;function C(){M||(M=!0,T.then(L))}function R(){return C(),T}function z(e){$.push(e)}const I=new Set;let j=0;function L(){const e=k;do{for(;j<_.length;){const e=_[j];j++,v(e),N(e.$$)}for(v(null),_.length=0,j=0;S.length;)S.pop()();for(let e=0;e<$.length;e+=1){const t=$[e];I.has(t)||(I.add(t),t())}$.length=0}while(_.length);for(;O.length;)O.pop()();M=!1,I.clear(),v(e)}function N(e){if(null!==e.fragment){e.update(),s(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(z)}}const F=new Set;let P;function B(){P={r:0,c:[],p:P}}function q(){P.r||s(P.c),P=P.p}function D(e,t){e&&e.i&&(F.delete(e),e.i(t))}function U(e,t,n,r){if(e&&e.o){if(F.has(e))return;F.add(e),P.c.push((()=>{F.delete(e),r&&(n&&e.d(1),r())})),e.o(t)}}function Z(e,t,r,o){const{fragment:a,on_mount:l,on_destroy:u,after_update:c}=e.$$;a&&a.m(t,r),o||z((()=>{const t=l.map(n).filter(i);u?u.push(...t):s(t),e.$$.on_mount=[]})),c.forEach(z)}function V(e,t){const n=e.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function H(e,n,i,o,a,l,c,p=[-1]){const h=k;v(e);const f=e.$$={fragment:null,ctx:null,props:l,update:t,not_equal:a,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(h?h.$$.context:[])),callbacks:r(),dirty:p,skip_bound:!1,root:n.target||h.$$.root};c&&c(f.root);let d=!1;if(f.ctx=i?i(e,n.props||{},((t,n,...r)=>{const s=r.length?r[0]:n;return f.ctx&&a(f.ctx[t],f.ctx[t]=s)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](s),d&&function(e,t){-1===e.$$.dirty[0]&&(_.push(e),C(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}(e,t)),n})):[],f.update(),d=!0,s(f.before_update),f.fragment=!!o&&o(f.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);f.fragment&&f.fragment.l(e),e.forEach(u)}else f.fragment&&f.fragment.c();n.intro&&D(e.$$.fragment),Z(e,n.target,n.anchor,n.customElement),L()}v(h)}class Q{$destroy(){V(this,1),this.$destroy=t}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const K="1.0.0";function G(e,t,n,r){if(void 0===e||void 0===t||void 0===n||void 0===r)throw new J(`getBotConfig() in state.js called with missing argument. newConfig=${e}; waitForStartNewConversation= ${r}, getConfigFromRemote=${t}; localStorageKey=${n}`);if(e)botJSON=W("TBD",n);else{let e=localStorage.getItem(n);if(!t||e||r||(e=W("TBD",n)),e){const t=Object.freeze(JSON.parse(e));if(X(t.version))return t}else if(!r)throw new J("getBotConfig() in state.js failed to acquire a botConfig from localStorage and remote and waitForStartNewConversation prop was false")}}function J(e){this.name="botConfig acquisition error",this.message=e,this.stack=(new Error).stack}function X(e){if(K[0]===e[0])return!0;throw new J(`botConfig version 1.0.2 or 1.0.0 doesn't match the version of the configuration file the bot read: ${e}.`)}async function W(e,t){try{const n=await fetch(e),r=await n.json();return localStorage.setItem(t,r),r}catch(e){console.log(e)}}function Y(e){return e+"conversation"}function ee(e){try{return JSON.parse(sessionStorage.getItem(Y(e)))}catch(e){return console.log(`error ${e} getting sessionStorage in getConversation()`),null}}function te(e,t){sessionStorage.setItem(Y(t),JSON.stringify(e))}J.prototype=new Error;var ne="INUMBER",re="IOP1",se="IOP2",ie="IOP3",oe="IVAR",ae="IVARNAME",le="IFUNCALL",ue="IFUNDEF",ce="IEXPR",pe="IEXPREVAL",he="IMEMBER",fe="IENDSTATEMENT",de="IARRAY";function ge(e,t){this.type=e,this.value=null!=t?t:0}function me(e){return new ge(re,e)}function xe(e){return new ge(se,e)}function ye(e){return new ge(ie,e)}function we(e,t,n,r,s){for(var i,o,a,l,u=[],c=[],p=0;p<e.length;p++){var h=e[p],f=h.type;if(f===ne||f===ae)Array.isArray(h.value)?u.push.apply(u,we(h.value.map((function(e){return new ge(ne,e)})).concat(new ge(de,h.value.length)),t,n,r,s)):u.push(h);else if(f===oe&&s.hasOwnProperty(h.value))h=new ge(ne,s[h.value]),u.push(h);else if(f===se&&u.length>1)o=u.pop(),i=u.pop(),l=n[h.value],h=new ge(ne,l(i.value,o.value)),u.push(h);else if(f===ie&&u.length>2)a=u.pop(),o=u.pop(),i=u.pop(),"?"===h.value?u.push(i.value?o.value:a.value):(l=r[h.value],h=new ge(ne,l(i.value,o.value,a.value)),u.push(h));else if(f===re&&u.length>0)i=u.pop(),l=t[h.value],h=new ge(ne,l(i.value)),u.push(h);else if(f===ce){for(;u.length>0;)c.push(u.shift());c.push(new ge(ce,we(h.value,t,n,r,s)))}else if(f===he&&u.length>0)i=u.pop(),u.push(new ge(ne,i.value[h.value]));else{for(;u.length>0;)c.push(u.shift());c.push(h)}}for(;u.length>0;)c.push(u.shift());return c}function be(e,t,n){for(var r=[],s=0;s<e.length;s++){var i=e[s],o=i.type;if(o===oe&&i.value===t)for(var a=0;a<n.tokens.length;a++){var l,u=n.tokens[a];l=u.type===re?me(u.value):u.type===se?xe(u.value):u.type===ie?ye(u.value):new ge(u.type,u.value),r.push(l)}else o===ce?r.push(new ge(ce,be(i.value,t,n))):r.push(i)}return r}function ke(e,t,n){var r,s,i,o,a,l,u=[];if(Ae(e))return Ee(e,n);for(var c=e.length,p=0;p<c;p++){var h=e[p],f=h.type;if(f===ne||f===ae)u.push(h.value);else if(f===se)s=u.pop(),r=u.pop(),"and"===h.value?u.push(!!r&&!!ke(s,t,n)):"or"===h.value?u.push(!!r||!!ke(s,t,n)):"="===h.value?(o=t.binaryOps[h.value],u.push(o(r,ke(s,t,n),n))):(o=t.binaryOps[h.value],u.push(o(Ee(r,n),Ee(s,n))));else if(f===ie)i=u.pop(),s=u.pop(),r=u.pop(),"?"===h.value?u.push(ke(r?s:i,t,n)):(o=t.ternaryOps[h.value],u.push(o(Ee(r,n),Ee(s,n),Ee(i,n))));else if(f===oe)if(h.value in t.functions)u.push(t.functions[h.value]);else if(h.value in t.unaryOps&&t.parser.isOperatorEnabled(h.value))u.push(t.unaryOps[h.value]);else{var d=n[h.value];if(void 0===d)throw new Error("undefined variable: "+h.value);u.push(d)}else if(f===re)r=u.pop(),o=t.unaryOps[h.value],u.push(o(Ee(r,n)));else if(f===le){for(l=h.value,a=[];l-- >0;)a.unshift(Ee(u.pop(),n));if(!(o=u.pop()).apply||!o.call)throw new Error(o+" is not a function");u.push(o.apply(void 0,a))}else if(f===ue)u.push(function(){for(var e=u.pop(),r=[],s=h.value;s-- >0;)r.unshift(u.pop());var i=u.pop(),o=function(){for(var s=Object.assign({},n),i=0,o=r.length;i<o;i++)s[r[i]]=arguments[i];return ke(e,t,s)};return Object.defineProperty(o,"name",{value:i,writable:!1}),n[i]=o,o}());else if(f===ce)u.push(ve(h,t));else if(f===pe)u.push(h);else if(f===he)r=u.pop(),u.push(r[h.value]);else if(f===fe)u.pop();else{if(f!==de)throw new Error("invalid Expression");for(l=h.value,a=[];l-- >0;)a.unshift(u.pop());u.push(a)}}if(u.length>1)throw new Error("invalid Expression (parity)");return 0===u[0]?0:Ee(u[0],n)}function ve(e,t,n){return Ae(e)?e:{type:pe,value:function(n){return ke(e.value,t,n)}}}function Ae(e){return e&&e.type===pe}function Ee(e,t){return Ae(e)?e.value(t):e}function _e(e,t){for(var n,r,s,i,o,a,l=[],u=0;u<e.length;u++){var c=e[u],p=c.type;if(p===ne)"number"==typeof c.value&&c.value<0?l.push("("+c.value+")"):Array.isArray(c.value)?l.push("["+c.value.map(Se).join(", ")+"]"):l.push(Se(c.value));else if(p===se)r=l.pop(),n=l.pop(),i=c.value,t?"^"===i?l.push("Math.pow("+n+", "+r+")"):"and"===i?l.push("(!!"+n+" && !!"+r+")"):"or"===i?l.push("(!!"+n+" || !!"+r+")"):"||"===i?l.push("(function(a,b){ return Array.isArray(a) && Array.isArray(b) ? a.concat(b) : String(a) + String(b); }(("+n+"),("+r+")))"):"=="===i?l.push("("+n+" === "+r+")"):"!="===i?l.push("("+n+" !== "+r+")"):"["===i?l.push(n+"[("+r+") | 0]"):l.push("("+n+" "+i+" "+r+")"):"["===i?l.push(n+"["+r+"]"):l.push("("+n+" "+i+" "+r+")");else if(p===ie){if(s=l.pop(),r=l.pop(),n=l.pop(),"?"!==(i=c.value))throw new Error("invalid Expression");l.push("("+n+" ? "+r+" : "+s+")")}else if(p===oe||p===ae)l.push(c.value);else if(p===re)n=l.pop(),"-"===(i=c.value)||"+"===i?l.push("("+i+n+")"):t?"not"===i?l.push("(!"+n+")"):"!"===i?l.push("fac("+n+")"):l.push(i+"("+n+")"):"!"===i?l.push("("+n+"!)"):l.push("("+i+" "+n+")");else if(p===le){for(a=c.value,o=[];a-- >0;)o.unshift(l.pop());i=l.pop(),l.push(i+"("+o.join(", ")+")")}else if(p===ue){for(r=l.pop(),a=c.value,o=[];a-- >0;)o.unshift(l.pop());n=l.pop(),t?l.push("("+n+" = function("+o.join(", ")+") { return "+r+" })"):l.push("("+n+"("+o.join(", ")+") = "+r+")")}else if(p===he)n=l.pop(),l.push(n+"."+c.value);else if(p===de){for(a=c.value,o=[];a-- >0;)o.unshift(l.pop());l.push("["+o.join(", ")+"]")}else if(p===ce)l.push("("+_e(c.value,t)+")");else if(p!==fe)throw new Error("invalid Expression")}return l.length>1&&(l=t?[l.join(",")]:[l.join(";")]),String(l[0])}function Se(e){return"string"==typeof e?JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029"):e}function $e(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return!0;return!1}function Oe(e,t,n){for(var r=!!(n=n||{}).withMembers,s=null,i=0;i<e.length;i++){var o=e[i];o.type===oe||o.type===ae?r||$e(t,o.value)?null!==s?($e(t,s)||t.push(s),s=o.value):s=o.value:t.push(o.value):o.type===he&&r&&null!==s?s+="."+o.value:o.type===ce?Oe(o.value,t,n):null!==s&&($e(t,s)||t.push(s),s=null)}null===s||$e(t,s)||t.push(s)}function Te(e,t){this.tokens=e,this.parser=t,this.unaryOps=t.unaryOps,this.binaryOps=t.binaryOps,this.ternaryOps=t.ternaryOps,this.functions=t.functions}ge.prototype.toString=function(){switch(this.type){case ne:case re:case se:case ie:case oe:case ae:case fe:return this.value;case le:return"CALL "+this.value;case ue:return"DEF "+this.value;case de:return"ARRAY "+this.value;case he:return"."+this.value;default:return"Invalid Instruction"}},Te.prototype.simplify=function(e){return e=e||{},new Te(we(this.tokens,this.unaryOps,this.binaryOps,this.ternaryOps,e),this.parser)},Te.prototype.substitute=function(e,t){return t instanceof Te||(t=this.parser.parse(String(t))),new Te(be(this.tokens,e,t),this.parser)},Te.prototype.evaluate=function(e){return e=e||{},ke(this.tokens,this,e)},Te.prototype.toString=function(){return _e(this.tokens,!1)},Te.prototype.symbols=function(e){e=e||{};var t=[];return Oe(this.tokens,t,e),t},Te.prototype.variables=function(e){e=e||{};var t=[];Oe(this.tokens,t,e);var n=this.functions;return t.filter((function(e){return!(e in n)}))},Te.prototype.toJSFunction=function(e,t){var n=this,r=new Function(e,"with(this.functions) with (this.ternaryOps) with (this.binaryOps) with (this.unaryOps) { return "+_e(this.simplify(t).tokens,!0)+"; }");return function(){return r.apply(n,arguments)}};var Me="TEOF",Ce="TOP",Re="TNUMBER",ze="TSTRING",Ie="TPAREN",je="TBRACKET",Le="TCOMMA",Ne="TNAME",Fe="TSEMICOLON";function Pe(e,t,n){this.type=e,this.value=t,this.index=n}function Be(e,t){this.pos=0,this.current=null,this.unaryOps=e.unaryOps,this.binaryOps=e.binaryOps,this.ternaryOps=e.ternaryOps,this.consts=e.consts,this.expression=t,this.savedPosition=0,this.savedCurrent=null,this.options=e.options,this.parser=e}Pe.prototype.toString=function(){return this.type+": "+this.value},Be.prototype.newToken=function(e,t,n){return new Pe(e,t,null!=n?n:this.pos)},Be.prototype.save=function(){this.savedPosition=this.pos,this.savedCurrent=this.current},Be.prototype.restore=function(){this.pos=this.savedPosition,this.current=this.savedCurrent},Be.prototype.next=function(){return this.pos>=this.expression.length?this.newToken(Me,"EOF"):this.isWhitespace()||this.isComment()?this.next():this.isRadixInteger()||this.isNumber()||this.isOperator()||this.isString()||this.isParen()||this.isBracket()||this.isComma()||this.isSemicolon()||this.isNamedOp()||this.isConst()||this.isName()?this.current:void this.parseError('Unknown character "'+this.expression.charAt(this.pos)+'"')},Be.prototype.isString=function(){var e=!1,t=this.pos,n=this.expression.charAt(t);if("'"===n||'"'===n)for(var r=this.expression.indexOf(n,t+1);r>=0&&this.pos<this.expression.length;){if(this.pos=r+1,"\\"!==this.expression.charAt(r-1)){var s=this.expression.substring(t+1,r);this.current=this.newToken(ze,this.unescape(s),t),e=!0;break}r=this.expression.indexOf(n,r+1)}return e},Be.prototype.isParen=function(){var e=this.expression.charAt(this.pos);return("("===e||")"===e)&&(this.current=this.newToken(Ie,e),this.pos++,!0)},Be.prototype.isBracket=function(){var e=this.expression.charAt(this.pos);return!("["!==e&&"]"!==e||!this.isOperatorEnabled("["))&&(this.current=this.newToken(je,e),this.pos++,!0)},Be.prototype.isComma=function(){return","===this.expression.charAt(this.pos)&&(this.current=this.newToken(Le,","),this.pos++,!0)},Be.prototype.isSemicolon=function(){return";"===this.expression.charAt(this.pos)&&(this.current=this.newToken(Fe,";"),this.pos++,!0)},Be.prototype.isConst=function(){for(var e=this.pos,t=e;t<this.expression.length;t++){var n=this.expression.charAt(t);if(n.toUpperCase()===n.toLowerCase()&&(t===this.pos||"_"!==n&&"."!==n&&(n<"0"||n>"9")))break}if(t>e){var r=this.expression.substring(e,t);if(r in this.consts)return this.current=this.newToken(Re,this.consts[r]),this.pos+=r.length,!0}return!1},Be.prototype.isNamedOp=function(){for(var e=this.pos,t=e;t<this.expression.length;t++){var n=this.expression.charAt(t);if(n.toUpperCase()===n.toLowerCase()&&(t===this.pos||"_"!==n&&(n<"0"||n>"9")))break}if(t>e){var r=this.expression.substring(e,t);if(this.isOperatorEnabled(r)&&(r in this.binaryOps||r in this.unaryOps||r in this.ternaryOps))return this.current=this.newToken(Ce,r),this.pos+=r.length,!0}return!1},Be.prototype.isName=function(){for(var e=this.pos,t=e,n=!1;t<this.expression.length;t++){var r=this.expression.charAt(t);if(r.toUpperCase()===r.toLowerCase()){if(t===this.pos&&("$"===r||"_"===r)){"_"===r&&(n=!0);continue}if(t===this.pos||!n||"_"!==r&&(r<"0"||r>"9"))break}else n=!0}if(n){var s=this.expression.substring(e,t);return this.current=this.newToken(Ne,s),this.pos+=s.length,!0}return!1},Be.prototype.isWhitespace=function(){for(var e=!1,t=this.expression.charAt(this.pos);!(" "!==t&&"\t"!==t&&"\n"!==t&&"\r"!==t||(e=!0,this.pos++,this.pos>=this.expression.length));)t=this.expression.charAt(this.pos);return e};var qe=/^[0-9a-f]{4}$/i;function De(e,t,n){this.parser=e,this.tokens=t,this.current=null,this.nextToken=null,this.next(),this.savedCurrent=null,this.savedNextToken=null,this.allowMemberAccess=!1!==n.allowMemberAccess}Be.prototype.unescape=function(e){var t=e.indexOf("\\");if(t<0)return e;for(var n=e.substring(0,t);t>=0;){var r=e.charAt(++t);switch(r){case"'":n+="'";break;case'"':n+='"';break;case"\\":n+="\\";break;case"/":n+="/";break;case"b":n+="\b";break;case"f":n+="\f";break;case"n":n+="\n";break;case"r":n+="\r";break;case"t":n+="\t";break;case"u":var s=e.substring(t+1,t+5);qe.test(s)||this.parseError("Illegal escape sequence: \\u"+s),n+=String.fromCharCode(parseInt(s,16)),t+=4;break;default:throw this.parseError('Illegal escape sequence: "\\'+r+'"')}++t;var i=e.indexOf("\\",t);n+=e.substring(t,i<0?e.length:i),t=i}return n},Be.prototype.isComment=function(){return"/"===this.expression.charAt(this.pos)&&"*"===this.expression.charAt(this.pos+1)&&(this.pos=this.expression.indexOf("*/",this.pos)+2,1===this.pos&&(this.pos=this.expression.length),!0)},Be.prototype.isRadixInteger=function(){var e,t,n=this.pos;if(n>=this.expression.length-2||"0"!==this.expression.charAt(n))return!1;if(++n,"x"===this.expression.charAt(n))e=16,t=/^[0-9a-f]$/i,++n;else{if("b"!==this.expression.charAt(n))return!1;e=2,t=/^[01]$/i,++n}for(var r=!1,s=n;n<this.expression.length;){var i=this.expression.charAt(n);if(!t.test(i))break;n++,r=!0}return r&&(this.current=this.newToken(Re,parseInt(this.expression.substring(s,n),e)),this.pos=n),r},Be.prototype.isNumber=function(){for(var e,t=!1,n=this.pos,r=n,s=n,i=!1,o=!1;n<this.expression.length&&((e=this.expression.charAt(n))>="0"&&e<="9"||!i&&"."===e);)"."===e?i=!0:o=!0,n++,t=o;if(t&&(s=n),"e"===e||"E"===e){n++;for(var a=!0,l=!1;n<this.expression.length;){if(e=this.expression.charAt(n),!a||"+"!==e&&"-"!==e){if(!(e>="0"&&e<="9"))break;l=!0,a=!1}else a=!1;n++}l||(n=s)}return t?(this.current=this.newToken(Re,parseFloat(this.expression.substring(r,n))),this.pos=n):this.pos=s,t},Be.prototype.isOperator=function(){var e=this.pos,t=this.expression.charAt(this.pos);if("+"===t||"-"===t||"*"===t||"/"===t||"%"===t||"^"===t||"?"===t||":"===t||"."===t)this.current=this.newToken(Ce,t);else if("∙"===t||"•"===t)this.current=this.newToken(Ce,"*");else if(">"===t)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(Ce,">="),this.pos++):this.current=this.newToken(Ce,">");else if("<"===t)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(Ce,"<="),this.pos++):this.current=this.newToken(Ce,"<");else if("|"===t){if("|"!==this.expression.charAt(this.pos+1))return!1;this.current=this.newToken(Ce,"||"),this.pos++}else if("="===t)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(Ce,"=="),this.pos++):this.current=this.newToken(Ce,t);else{if("!"!==t)return!1;"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(Ce,"!="),this.pos++):this.current=this.newToken(Ce,t)}return this.pos++,!!this.isOperatorEnabled(this.current.value)||(this.pos=e,!1)},Be.prototype.isOperatorEnabled=function(e){return this.parser.isOperatorEnabled(e)},Be.prototype.getCoordinates=function(){var e,t=0,n=-1;do{t++,e=this.pos-n,n=this.expression.indexOf("\n",n+1)}while(n>=0&&n<this.pos);return{line:t,column:e}},Be.prototype.parseError=function(e){var t=this.getCoordinates();throw new Error("parse error ["+t.line+":"+t.column+"]: "+e)},De.prototype.next=function(){return this.current=this.nextToken,this.nextToken=this.tokens.next()},De.prototype.tokenMatches=function(e,t){return void 0===t||(Array.isArray(t)?$e(t,e.value):"function"==typeof t?t(e):e.value===t)},De.prototype.save=function(){this.savedCurrent=this.current,this.savedNextToken=this.nextToken,this.tokens.save()},De.prototype.restore=function(){this.tokens.restore(),this.current=this.savedCurrent,this.nextToken=this.savedNextToken},De.prototype.accept=function(e,t){return!(this.nextToken.type!==e||!this.tokenMatches(this.nextToken,t))&&(this.next(),!0)},De.prototype.expect=function(e,t){if(!this.accept(e,t)){var n=this.tokens.getCoordinates();throw new Error("parse error ["+n.line+":"+n.column+"]: Expected "+(t||e))}},De.prototype.parseAtom=function(e){var t=this.tokens.unaryOps;if(this.accept(Ne)||this.accept(Ce,(function(e){return e.value in t})))e.push(new ge(oe,this.current.value));else if(this.accept(Re))e.push(new ge(ne,this.current.value));else if(this.accept(ze))e.push(new ge(ne,this.current.value));else if(this.accept(Ie,"("))this.parseExpression(e),this.expect(Ie,")");else{if(!this.accept(je,"["))throw new Error("unexpected "+this.nextToken);if(this.accept(je,"]"))e.push(new ge(de,0));else{var n=this.parseArrayList(e);e.push(new ge(de,n))}}},De.prototype.parseExpression=function(e){var t=[];this.parseUntilEndStatement(e,t)||(this.parseVariableAssignmentExpression(t),this.parseUntilEndStatement(e,t)||this.pushExpression(e,t))},De.prototype.pushExpression=function(e,t){for(var n=0,r=t.length;n<r;n++)e.push(t[n])},De.prototype.parseUntilEndStatement=function(e,t){return!!this.accept(Fe)&&(!this.nextToken||this.nextToken.type===Me||this.nextToken.type===Ie&&")"===this.nextToken.value||t.push(new ge(fe)),this.nextToken.type!==Me&&this.parseExpression(t),e.push(new ge(ce,t)),!0)},De.prototype.parseArrayList=function(e){for(var t=0;!this.accept(je,"]");)for(this.parseExpression(e),++t;this.accept(Le);)this.parseExpression(e),++t;return t},De.prototype.parseVariableAssignmentExpression=function(e){for(this.parseConditionalExpression(e);this.accept(Ce,"=");){var t=e.pop(),n=[],r=e.length-1;if(t.type!==le){if(t.type!==oe&&t.type!==he)throw new Error("expected variable for assignment");this.parseVariableAssignmentExpression(n),e.push(new ge(ae,t.value)),e.push(new ge(ce,n)),e.push(xe("="))}else{if(!this.tokens.isOperatorEnabled("()="))throw new Error("function definition is not permitted");for(var s=0,i=t.value+1;s<i;s++){var o=r-s;e[o].type===oe&&(e[o]=new ge(ae,e[o].value))}this.parseVariableAssignmentExpression(n),e.push(new ge(ce,n)),e.push(new ge(ue,t.value))}}},De.prototype.parseConditionalExpression=function(e){for(this.parseOrExpression(e);this.accept(Ce,"?");){var t=[],n=[];this.parseConditionalExpression(t),this.expect(Ce,":"),this.parseConditionalExpression(n),e.push(new ge(ce,t)),e.push(new ge(ce,n)),e.push(ye("?"))}},De.prototype.parseOrExpression=function(e){for(this.parseAndExpression(e);this.accept(Ce,"or");){var t=[];this.parseAndExpression(t),e.push(new ge(ce,t)),e.push(xe("or"))}},De.prototype.parseAndExpression=function(e){for(this.parseComparison(e);this.accept(Ce,"and");){var t=[];this.parseComparison(t),e.push(new ge(ce,t)),e.push(xe("and"))}};var Ue=["==","!=","<","<=",">=",">","in"];De.prototype.parseComparison=function(e){for(this.parseAddSub(e);this.accept(Ce,Ue);){var t=this.current;this.parseAddSub(e),e.push(xe(t.value))}};var Ze=["+","-","||"];De.prototype.parseAddSub=function(e){for(this.parseTerm(e);this.accept(Ce,Ze);){var t=this.current;this.parseTerm(e),e.push(xe(t.value))}};var Ve=["*","/","%"];function He(e,t){return Number(e)+Number(t)}function Qe(e,t){return e-t}function Ke(e,t){return e*t}function Ge(e,t){return e/t}function Je(e,t){return e%t}function Xe(e,t){return Array.isArray(e)&&Array.isArray(t)?e.concat(t):""+e+t}function We(e,t){return e===t}function Ye(e,t){return e!==t}function et(e,t){return e>t}function tt(e,t){return e<t}function nt(e,t){return e>=t}function rt(e,t){return e<=t}function st(e,t){return Boolean(e&&t)}function it(e,t){return Boolean(e||t)}function ot(e,t){return $e(t,e)}function at(e){return(Math.exp(e)-Math.exp(-e))/2}function lt(e){return(Math.exp(e)+Math.exp(-e))/2}function ut(e){return e===1/0?1:e===-1/0?-1:(Math.exp(e)-Math.exp(-e))/(Math.exp(e)+Math.exp(-e))}function ct(e){return e===-1/0?e:Math.log(e+Math.sqrt(e*e+1))}function pt(e){return Math.log(e+Math.sqrt(e*e-1))}function ht(e){return Math.log((1+e)/(1-e))/2}function ft(e){return Math.log(e)*Math.LOG10E}function dt(e){return-e}function gt(e){return!e}function mt(e){return e<0?Math.ceil(e):Math.floor(e)}function xt(e){return Math.random()*(e||1)}function yt(e){return bt(e+1)}De.prototype.parseTerm=function(e){for(this.parseFactor(e);this.accept(Ce,Ve);){var t=this.current;this.parseFactor(e),e.push(xe(t.value))}},De.prototype.parseFactor=function(e){var t=this.tokens.unaryOps;if(this.save(),this.accept(Ce,(function(e){return e.value in t}))){if("-"!==this.current.value&&"+"!==this.current.value){if(this.nextToken.type===Ie&&"("===this.nextToken.value)return this.restore(),void this.parseExponential(e);if(this.nextToken.type===Fe||this.nextToken.type===Le||this.nextToken.type===Me||this.nextToken.type===Ie&&")"===this.nextToken.value)return this.restore(),void this.parseAtom(e)}var n=this.current;this.parseFactor(e),e.push(me(n.value))}else this.parseExponential(e)},De.prototype.parseExponential=function(e){for(this.parsePostfixExpression(e);this.accept(Ce,"^");)this.parseFactor(e),e.push(xe("^"))},De.prototype.parsePostfixExpression=function(e){for(this.parseFunctionCall(e);this.accept(Ce,"!");)e.push(me("!"))},De.prototype.parseFunctionCall=function(e){var t=this.tokens.unaryOps;if(this.accept(Ce,(function(e){return e.value in t}))){var n=this.current;this.parseAtom(e),e.push(me(n.value))}else for(this.parseMemberExpression(e);this.accept(Ie,"(");)if(this.accept(Ie,")"))e.push(new ge(le,0));else{var r=this.parseArgumentList(e);e.push(new ge(le,r))}},De.prototype.parseArgumentList=function(e){for(var t=0;!this.accept(Ie,")");)for(this.parseExpression(e),++t;this.accept(Le);)this.parseExpression(e),++t;return t},De.prototype.parseMemberExpression=function(e){for(this.parseAtom(e);this.accept(Ce,".")||this.accept(je,"[");){var t=this.current;if("."===t.value){if(!this.allowMemberAccess)throw new Error('unexpected ".", member access is not permitted');this.expect(Ne),e.push(new ge(he,this.current.value))}else{if("["!==t.value)throw new Error("unexpected symbol: "+t.value);if(!this.tokens.isOperatorEnabled("["))throw new Error('unexpected "[]", arrays are disabled');this.parseExpression(e),this.expect(je,"]"),e.push(xe("["))}}};var wt=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];function bt(e){var t,n;if(function(e){return isFinite(e)&&e===Math.round(e)}(e)){if(e<=0)return isFinite(e)?1/0:NaN;if(e>171)return 1/0;for(var r=e-2,s=e-1;r>1;)s*=r,r--;return 0===s&&(s=1),s}if(e<.5)return Math.PI/(Math.sin(Math.PI*e)*bt(1-e));if(e>=171.35)return 1/0;if(e>85){var i=e*e,o=i*e,a=o*e,l=a*e;return Math.sqrt(2*Math.PI/e)*Math.pow(e/Math.E,e)*(1+1/(12*e)+1/(288*i)-139/(51840*o)-571/(2488320*a)+163879/(209018880*l)+5246819/(75246796800*l*e))}--e,n=wt[0];for(var u=1;u<wt.length;++u)n+=wt[u]/(e+u);return t=e+4.7421875+.5,Math.sqrt(2*Math.PI)*Math.pow(t,e+.5)*Math.exp(-t)*n}function kt(e){return Array.isArray(e)?e.length:String(e).length}function vt(){for(var e=0,t=0,n=0;n<arguments.length;n++){var r,s=Math.abs(arguments[n]);t<s?(e=e*(r=t/s)*r+1,t=s):e+=s>0?(r=s/t)*r:s}return t===1/0?1/0:t*Math.sqrt(e)}function At(e,t,n){return e?t:n}function Et(e,t){return void 0===t||0==+t?Math.round(e):(e=+e,t=-+t,isNaN(e)||"number"!=typeof t||t%1!=0?NaN:(e=e.toString().split("e"),+((e=(e=Math.round(+(e[0]+"e"+(e[1]?+e[1]-t:-t)))).toString().split("e"))[0]+"e"+(e[1]?+e[1]+t:t))))}function _t(e,t,n){return n&&(n[e]=t),t}function St(e,t){return e[0|t]}function $t(e){return 1===arguments.length&&Array.isArray(e)?Math.max.apply(Math,e):Math.max.apply(Math,arguments)}function Ot(e){return 1===arguments.length&&Array.isArray(e)?Math.min.apply(Math,e):Math.min.apply(Math,arguments)}function Tt(e,t){if("function"!=typeof e)throw new Error("First argument to map is not a function");if(!Array.isArray(t))throw new Error("Second argument to map is not an array");return t.map((function(t,n){return e(t,n)}))}function Mt(e,t,n){if("function"!=typeof e)throw new Error("First argument to fold is not a function");if(!Array.isArray(n))throw new Error("Second argument to fold is not an array");return n.reduce((function(t,n,r){return e(t,n,r)}),t)}function Ct(e,t){if("function"!=typeof e)throw new Error("First argument to filter is not a function");if(!Array.isArray(t))throw new Error("Second argument to filter is not an array");return t.filter((function(t,n){return e(t,n)}))}function Rt(e,t){if(!Array.isArray(t)&&"string"!=typeof t)throw new Error("Second argument to indexOf is not a string or array");return t.indexOf(e)}function zt(e,t){if(!Array.isArray(t))throw new Error("Second argument to join is not an array");return t.join(e)}function It(e){return(e>0)-(e<0)||+e}var jt=1/3;function Lt(e){return e<0?-Math.pow(-e,jt):Math.pow(e,jt)}function Nt(e){return Math.exp(e)-1}function Ft(e){return Math.log(1+e)}function Pt(e){return Math.log(e)/Math.LN2}function Bt(e){this.options=e||{},this.unaryOps={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sinh:Math.sinh||at,cosh:Math.cosh||lt,tanh:Math.tanh||ut,asinh:Math.asinh||ct,acosh:Math.acosh||pt,atanh:Math.atanh||ht,sqrt:Math.sqrt,cbrt:Math.cbrt||Lt,log:Math.log,log2:Math.log2||Pt,ln:Math.log,lg:Math.log10||ft,log10:Math.log10||ft,expm1:Math.expm1||Nt,log1p:Math.log1p||Ft,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,trunc:Math.trunc||mt,"-":dt,"+":Number,exp:Math.exp,not:gt,length:kt,"!":yt,sign:Math.sign||It},this.binaryOps={"+":He,"-":Qe,"*":Ke,"/":Ge,"%":Je,"^":Math.pow,"||":Xe,"==":We,"!=":Ye,">":et,"<":tt,">=":nt,"<=":rt,and:st,or:it,in:ot,"=":_t,"[":St},this.ternaryOps={"?":At},this.functions={random:xt,fac:yt,min:Ot,max:$t,hypot:Math.hypot||vt,pyt:Math.hypot||vt,pow:Math.pow,atan2:Math.atan2,if:At,gamma:bt,roundTo:Et,map:Tt,fold:Mt,filter:Ct,indexOf:Rt,join:zt},this.consts={E:Math.E,PI:Math.PI,true:!0,false:!1}}Bt.prototype.parse=function(e){var t=[],n=new De(this,new Be(this,e),{allowMemberAccess:this.options.allowMemberAccess});return n.parseExpression(t),n.expect(Me,"EOF"),new Te(t,this)},Bt.prototype.evaluate=function(e,t){return this.parse(e).evaluate(t)};var qt=new Bt;Bt.parse=function(e){return qt.parse(e)},Bt.evaluate=function(e,t){return qt.parse(e).evaluate(t)};var Dt={"+":"add","-":"subtract","*":"multiply","/":"divide","%":"remainder","^":"power","!":"factorial","<":"comparison",">":"comparison","<=":"comparison",">=":"comparison","==":"comparison","!=":"comparison","||":"concatenate",and:"logical",or:"logical",not:"logical","?":"conditional",":":"conditional","=":"assignment","[":"array","()=":"fndef"};Bt.prototype.isOperatorEnabled=function(e){var t=function(e){return Dt.hasOwnProperty(e)?Dt[e]:e}(e),n=this.options.operators||{};return!(t in n)||!!n[t]};
/*!
     Based on ndef.parser, by Raphael Graf(r@undefined.ch)
     http://www.undefined.ch/mparser/index.html

     Ported to JavaScript and modified by Matthew Crumley (email@matthewcrumley.com, http://silentmatt.com/)

     You are free to use and modify this code in anyway you find useful. Please leave this comment in the code
     to acknowledge its original source. If you feel like it, I enjoy hearing about projects that use my code,
     but don't feel like you have to let me know or ask permission.
    */
var Ut={Parser:Bt,Expression:Te};function Zt(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})})),t}var Vt=Zt(Object.freeze({__proto__:null,default:Ut,Expression:Te,Parser:Bt}));function Ht(e){return null!=e&&"object"==typeof e&&!0===e["@@functional/placeholder"]}function Qt(e){return function t(n){return 0===arguments.length||Ht(n)?t:e.apply(this,arguments)}}function Kt(e){return function t(n,r){switch(arguments.length){case 0:return t;case 1:return Ht(n)?t:Qt((function(t){return e(n,t)}));default:return Ht(n)&&Ht(r)?t:Ht(n)?Qt((function(t){return e(t,r)})):Ht(r)?Qt((function(t){return e(n,t)})):e(n,r)}}}function Gt(e,t){switch(e){case 0:return function(){return t.apply(this,arguments)};case 1:return function(e){return t.apply(this,arguments)};case 2:return function(e,n){return t.apply(this,arguments)};case 3:return function(e,n,r){return t.apply(this,arguments)};case 4:return function(e,n,r,s){return t.apply(this,arguments)};case 5:return function(e,n,r,s,i){return t.apply(this,arguments)};case 6:return function(e,n,r,s,i,o){return t.apply(this,arguments)};case 7:return function(e,n,r,s,i,o,a){return t.apply(this,arguments)};case 8:return function(e,n,r,s,i,o,a,l){return t.apply(this,arguments)};case 9:return function(e,n,r,s,i,o,a,l,u){return t.apply(this,arguments)};case 10:return function(e,n,r,s,i,o,a,l,u,c){return t.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}}function Jt(e,t,n){return function(){for(var r=[],s=0,i=e,o=0;o<t.length||s<arguments.length;){var a;o<t.length&&(!Ht(t[o])||s>=arguments.length)?a=t[o]:(a=arguments[s],s+=1),r[o]=a,Ht(a)||(i-=1),o+=1}return i<=0?n.apply(this,r):Gt(i,Jt(e,r,n))}}var Xt=Kt((function(e,t){return 1===e?Qt(t):Gt(e,Jt(e,[],t))}));function Wt(e){return function t(n,r,s){switch(arguments.length){case 0:return t;case 1:return Ht(n)?t:Kt((function(t,r){return e(n,t,r)}));case 2:return Ht(n)&&Ht(r)?t:Ht(n)?Kt((function(t,n){return e(t,r,n)})):Ht(r)?Kt((function(t,r){return e(n,t,r)})):Qt((function(t){return e(n,r,t)}));default:return Ht(n)&&Ht(r)&&Ht(s)?t:Ht(n)&&Ht(r)?Kt((function(t,n){return e(t,n,s)})):Ht(n)&&Ht(s)?Kt((function(t,n){return e(t,r,n)})):Ht(r)&&Ht(s)?Kt((function(t,r){return e(n,t,r)})):Ht(n)?Qt((function(t){return e(t,r,s)})):Ht(r)?Qt((function(t){return e(n,t,s)})):Ht(s)?Qt((function(t){return e(n,r,t)})):e(n,r,s)}}}var Yt=Array.isArray||function(e){return null!=e&&e.length>=0&&"[object Array]"===Object.prototype.toString.call(e)};function en(e){return null!=e&&"function"==typeof e["@@transducer/step"]}function tn(e,t,n){return function(){if(0===arguments.length)return n();var r=Array.prototype.slice.call(arguments,0),s=r.pop();if(!Yt(s)){for(var i=0;i<e.length;){if("function"==typeof s[e[i]])return s[e[i]].apply(s,r);i+=1}if(en(s)){var o=t.apply(null,r);return o(s)}}return n.apply(this,arguments)}}var nn=function(){return this.xf["@@transducer/init"]()},rn=function(e){return this.xf["@@transducer/result"](e)};function sn(e){return"[object String]"===Object.prototype.toString.call(e)}var on=Qt((function(e){return!!Yt(e)||!!e&&("object"==typeof e&&(!sn(e)&&(1===e.nodeType?!!e.length:0===e.length||e.length>0&&(e.hasOwnProperty(0)&&e.hasOwnProperty(e.length-1)))))})),an=function(){function e(e){this.f=e}return e.prototype["@@transducer/init"]=function(){throw new Error("init not implemented on XWrap")},e.prototype["@@transducer/result"]=function(e){return e},e.prototype["@@transducer/step"]=function(e,t){return this.f(e,t)},e}();var ln=Kt((function(e,t){return Gt(e.length,(function(){return e.apply(t,arguments)}))})),un=ln;function cn(e,t,n){for(var r=n.next();!r.done;){if((t=e["@@transducer/step"](t,r.value))&&t["@@transducer/reduced"]){t=t["@@transducer/value"];break}r=n.next()}return e["@@transducer/result"](t)}function pn(e,t,n,r){return e["@@transducer/result"](n[r](un(e["@@transducer/step"],e),t))}var hn="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator";function fn(e,t,n){if("function"==typeof e&&(e=function(e){return new an(e)}(e)),on(n))return function(e,t,n){for(var r=0,s=n.length;r<s;){if((t=e["@@transducer/step"](t,n[r]))&&t["@@transducer/reduced"]){t=t["@@transducer/value"];break}r+=1}return e["@@transducer/result"](t)}(e,t,n);if("function"==typeof n["fantasy-land/reduce"])return pn(e,t,n,"fantasy-land/reduce");if(null!=n[hn])return cn(e,t,n[hn]());if("function"==typeof n.next)return cn(e,t,n);if("function"==typeof n.reduce)return pn(e,t,n,"reduce");throw new TypeError("reduce: list must be array or iterable")}var dn=function(){function e(e,t){this.xf=t,this.f=e}return e.prototype["@@transducer/init"]=nn,e.prototype["@@transducer/result"]=rn,e.prototype["@@transducer/step"]=function(e,t){return this.xf["@@transducer/step"](e,this.f(t))},e}(),gn=Kt((function(e,t){return new dn(e,t)}));function mn(e,t){return Object.prototype.hasOwnProperty.call(t,e)}var xn=Object.prototype.toString,yn=function(){return"[object Arguments]"===xn.call(arguments)?function(e){return"[object Arguments]"===xn.call(e)}:function(e){return mn("callee",e)}}(),wn=yn,bn=!{toString:null}.propertyIsEnumerable("toString"),kn=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],vn=function(){return arguments.propertyIsEnumerable("length")}(),An=function(e,t){for(var n=0;n<e.length;){if(e[n]===t)return!0;n+=1}return!1},En="function"!=typeof Object.keys||vn?Qt((function(e){if(Object(e)!==e)return[];var t,n,r=[],s=vn&&wn(e);for(t in e)!mn(t,e)||s&&"length"===t||(r[r.length]=t);if(bn)for(n=kn.length-1;n>=0;)mn(t=kn[n],e)&&!An(r,t)&&(r[r.length]=t),n-=1;return r})):Qt((function(e){return Object(e)!==e?[]:Object.keys(e)})),_n=En,Sn=Kt(tn(["fantasy-land/map","map"],gn,(function(e,t){switch(Object.prototype.toString.call(t)){case"[object Function]":return Xt(t.length,(function(){return e.call(this,t.apply(this,arguments))}));case"[object Object]":return fn((function(n,r){return n[r]=e(t[r]),n}),{},_n(t));default:return function(e,t){for(var n=0,r=t.length,s=Array(r);n<r;)s[n]=e(t[n]),n+=1;return s}(e,t)}}))),$n=Sn,On=Number.isInteger||function(e){return e<<0===e},Tn=Kt((function(e,t){var n=e<0?t.length+e:e;return sn(t)?t.charAt(n):t[n]})),Mn=Kt((function(e,t){return e.map((function(e){for(var n,r=t,s=0;s<e.length;){if(null==r)return;n=e[s],r=On(n)?Tn(n,r):r[n],s+=1}return r}))})),Cn=Kt((function(e,t){return Mn([e],t)[0]})),Rn=Kt((function(e,t){return Cn([e],t)})),zn=Wt((function(e,t,n){var r={};for(var s in n)r[s]=n[s];return r[e]=t,r})),In=zn,jn=Qt((function(e){return null==e})),Ln=Wt((function e(t,n,r){if(0===t.length)return n;var s=t[0];if(t.length>1){var i=!jn(r)&&mn(s,r)?r[s]:On(t[1])?[]:{};n=e(Array.prototype.slice.call(t,1),n,i)}if(On(s)&&Yt(r)){var o=[].concat(r);return o[s]=n,o}return In(s,n,r)})),Nn=Ln;var Fn=Qt((function(e){return null===e?"Null":void 0===e?"Undefined":Object.prototype.toString.call(e).slice(8,-1)}));function Pn(e,t,n,r){var s,i=function(s){for(var i=t.length,o=0;o<i;){if(e===t[o])return n[o];o+=1}for(var a in t[o+1]=e,n[o+1]=s,e)s[a]=r?Pn(e[a],t,n,!0):e[a];return s};switch(Fn(e)){case"Object":return i({});case"Array":return i([]);case"Date":return new Date(e.valueOf());case"RegExp":return s=e,new RegExp(s.source,(s.global?"g":"")+(s.ignoreCase?"i":"")+(s.multiline?"m":"")+(s.sticky?"y":"")+(s.unicode?"u":""));default:return e}}var Bn=Qt((function(e){return null!=e&&"function"==typeof e.clone?e.clone():Pn(e,[],[],!0)}));function qn(e,t){return function(){var n=arguments.length;if(0===n)return t();var r=arguments[n-1];return Yt(r)||"function"!=typeof r[e]?t.apply(this,arguments):r[e].apply(r,Array.prototype.slice.call(arguments,0,n-1))}}var Dn=Wt(qn("slice",(function(e,t,n){return Array.prototype.slice.call(n,e,t)}))),Un=function(){function e(e,t){this.xf=t,this.n=e,this.i=0}return e.prototype["@@transducer/init"]=nn,e.prototype["@@transducer/result"]=rn,e.prototype["@@transducer/step"]=function(e,t){this.i+=1;var n,r=0===this.n?e:this.xf["@@transducer/step"](e,t);return this.n>=0&&this.i>=this.n?(n=r)&&n["@@transducer/reduced"]?n:{"@@transducer/value":n,"@@transducer/reduced":!0}:r},e}(),Zn=Kt(tn(["take"],Kt((function(e,t){return new Un(e,t)})),(function(e,t){return Dn(0,e<0?1/0:e,t)})));function Vn(e,t){return Zn(e<t.length?t.length-e:0,t)}var Hn=function(){function e(e,t){this.xf=t,this.pos=0,this.full=!1,this.acc=new Array(e)}return e.prototype["@@transducer/init"]=nn,e.prototype["@@transducer/result"]=function(e){return this.acc=null,this.xf["@@transducer/result"](e)},e.prototype["@@transducer/step"]=function(e,t){return this.full&&(e=this.xf["@@transducer/step"](e,this.acc[this.pos])),this.store(t),e},e.prototype.store=function(e){this.acc[this.pos]=e,this.pos+=1,this.pos===this.acc.length&&(this.pos=0,this.full=!0)},e}(),Qn=Kt(tn([],Kt((function(e,t){return new Hn(e,t)})),Vn)),Kn=Kt((function(e,t){return function(n){return function(r){return $n((function(e){return t(e,r)}),n(e(r)))}}})),Gn=Qt((function(e){return Kn(Cn(e),Nn(e))})),Jn=Qt((function(e){return Kn(Rn(e),In(e))})),Xn=function(e){return{value:e,"fantasy-land/map":function(){return this}}},Wn=Kt((function(e,t){return e(Xn)(t).value})),Yn=Wn;const er=["done","not done"];Jn("startFrameId");const tr=Jn("frames");Jn("name");const nr=Object.freeze({single:"single",multiple:"multiple",diagnostic:"diagnostic",newTabAnswer:"newTabAnswer",answer:"answer",endConversation:"endConversation"});function rr(e="",t={}){for(const n of(e=>Object.values(Yn(tr,e)))(t))for(const t of n.slots)if(t.name===e)return t;return null}Jn("name");Jn("replies");const sr=new(0,Vt.Parser);function ir(e,t,n=null){return(r,s)=>{if(!r||Array.isArray(r))throw new cr("The first argument in a trigger formula must be a question name.");if(n&&!rr(r,n))throw new cr(`The question name "${r}" does not exist. Possibly a typo?\n       Correct typo or add ${r} to a tag so the trigger can evaluate it.`);if(!s||0==s.length)throw new cr(`Trigger formulas must have one or more indexes as the second argument\n        - check triggers that include ${r}`);const i=e[r];return!!i&&t(i,s)}}function or(e,t){if(!Array.isArray(e)||!Array.isArray(t))throw new Error("hasSameMembers() called with non-array argument");const n=[...e].sort(),r=[...t].sort();return n.length===r.length&&n.every(((e,t)=>e===r[t]))}function ar(e,t){if(!Array.isArray(e)||!Array.isArray(t))throw new Error("isSubSet() called with non-array argument");return e.every((e=>t.includes(e)))}function lr(e,t){if(!Array.isArray(e)||!Array.isArray(t))throw new Error("hasOneOrMoreSharedMember() called with non-array argument");for(let n of e)if(t.includes(n))return!0;return!1}function ur(e="",t=null){return t?view(((e,t)=>Gn(["replies",e,t]))(e,t),bot):view(Gn(["replies",e]),bot)}function cr(e){this.name="Trigger Missing Or Invalid",this.message=e,this.exampleHTMLStr="Example:<br>\n    slot.trigger: same('TOSAccepted', [0])<br><br>",this.stack=(new Error).stack}cr.prototype=new Error;const pr=Object.freeze({completed:"completed",invalidReply:"invalidReply",abandoned:"abandoned",chatAgent:"chatAgent",callAgent:"callAgent"});function hr(e,t,n){if(void 0===e||void 0===t||void 0===n)return console.log(`initConversation(): an argument is undefined: \n      bot:${e}\ncurrentFrame:${t}\nlocalStorageKey:${n}`),null;const r=(({frames:e=[],currentFrame:t="",replies:n={},botCosmetics:r={}})=>({currentFrame:t,localeString:e[t].localeString,introduction:e[t].introduction,unSpokenFrames:Bn(e),completedRounds:[],allReplyOptions:Bn(n),botCosmetics:r}))({frames:e.frames,currentFrame:t,replies:e.replies,botCosmetics:e.botCosmetics});return te(r,n),r}function fr(e){const t=ee(e),n=t.unSpokenFrames[t.currentFrame].slots,r=function(e){let t={};return e.forEach((e=>{t[e.slot.name]=e.userReplyIndexes})),t}(t.completedRounds);sr.functions.same=ir(r,or),sr.functions.subset=ir(r,ar),sr.functions.share=ir(r,lr),sr.functions.reply=ir(r,ur);const s=function(e,t){return e.find((e=>{try{return""===e.trigger||void 0===e.trigger||"true"===e.trigger||function(e,t){if(!e)throw new cr("Trigger argument must not be empty.");if(0===Object.keys(t).length)throw new cr("Adding a trigger to the first slot is unnecessary since the first slot will always execute.");try{const n=sr.evaluate(e,t);if("boolean"==typeof n)return n;throw new cr(`Triggers must evaluate to true or false.  \n                                  "${e}" did not.`)}catch(t){throw console.log(t),new cr(`${t} in "${e}"`)}}(e.trigger,t)}catch(e){if("triggerMissingOrInvalidError"===e.name)return console.log(e),!1;throw e}}))}(n,r);if(void 0===s)return{completedRounds:Bn(t.completedRounds),replyType:nr.endConversation,replyOptions:null};if(0===t.completedRounds.length||t.completedRounds.length>0&&s.name!==t.completedRounds[t.completedRounds.length-1].slot.name){const n=(({slot:e={},frameId:t="",userReplyValues:n=[],userReplyIndexes:r=[],ending:s="",stats:i={}})=>({slot:e,frameId:t,userReplyValues:n,userReplyIndexes:r,ending:s,stats:i}))({slot:Bn(s),frameId:t.currentFrame});t.completedRounds.push(n),te(t,e)}return{completedRounds:Bn(t.completedRounds),replyType:Bn(s.type),replyOptions:Bn(t.allReplyOptions[s.replyId])}}function dr(e,t){const n=e.unSpokenFrames[e.currentFrame].slots.findIndex((e=>e.name===t.slot.name));e.unSpokenFrames[e.currentFrame].slots.splice(n,1)}function gr({userReplyValues:e,userReplyIndexes:t,ending:n,stats:r,localStorageKey:s}){const i=ee(s),o=i.completedRounds[i.completedRounds.length-1];o.userReplyValues=e,o.userReplyIndexes=t,o.ending=n,o.stats=r,dr(i,o),te(i,s)}function mr(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}let xr={baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1};const yr=/[&<>"']/,wr=/[&<>"']/g,br=/[<>"']|&(?!#?\w+;)/,kr=/[<>"']|&(?!#?\w+;)/g,vr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ar=e=>vr[e];function Er(e,t){if(t){if(yr.test(e))return e.replace(wr,Ar)}else if(br.test(e))return e.replace(kr,Ar);return e}const _r=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function Sr(e){return e.replace(_r,((e,t)=>"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}const $r=/(^|[^\[])\^/g;function Or(e,t){e=e.source||e,t=t||"";const n={replace:(t,r)=>(r=(r=r.source||r).replace($r,"$1"),e=e.replace(t,r),n),getRegex:()=>new RegExp(e,t)};return n}const Tr=/[^\w:]/g,Mr=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function Cr(e,t,n){if(e){let e;try{e=decodeURIComponent(Sr(n)).replace(Tr,"").toLowerCase()}catch(e){return null}if(0===e.indexOf("javascript:")||0===e.indexOf("vbscript:")||0===e.indexOf("data:"))return null}t&&!Mr.test(n)&&(n=function(e,t){Rr[" "+e]||(zr.test(e)?Rr[" "+e]=e+"/":Rr[" "+e]=Pr(e,"/",!0));const n=-1===(e=Rr[" "+e]).indexOf(":");return"//"===t.substring(0,2)?n?t:e.replace(Ir,"$1")+t:"/"===t.charAt(0)?n?t:e.replace(jr,"$1")+t:e+t}(t,n));try{n=encodeURI(n).replace(/%25/g,"%")}catch(e){return null}return n}const Rr={},zr=/^[^:]+:\/*[^/]*$/,Ir=/^([^:]+:)[\s\S]*$/,jr=/^([^:]+:\/*[^/]*)[\s\S]*$/;const Lr={exec:function(){}};function Nr(e){let t,n,r=1;for(;r<arguments.length;r++)for(n in t=arguments[r],t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function Fr(e,t){const n=e.replace(/\|/g,((e,t,n)=>{let r=!1,s=t;for(;--s>=0&&"\\"===n[s];)r=!r;return r?"|":" |"})).split(/ \|/);let r=0;if(n[0].trim()||n.shift(),n[n.length-1].trim()||n.pop(),n.length>t)n.splice(t);else for(;n.length<t;)n.push("");for(;r<n.length;r++)n[r]=n[r].trim().replace(/\\\|/g,"|");return n}function Pr(e,t,n){const r=e.length;if(0===r)return"";let s=0;for(;s<r;){const i=e.charAt(r-s-1);if(i!==t||n){if(i===t||!n)break;s++}else s++}return e.substr(0,r-s)}function Br(e){e&&e.sanitize&&!e.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function qr(e,t){if(t<1)return"";let n="";for(;t>1;)1&t&&(n+=e),t>>=1,e+=e;return n+e}function Dr(e,t,n,r){const s=t.href,i=t.title?Er(t.title):null,o=e[1].replace(/\\([\[\]])/g,"$1");if("!"!==e[0].charAt(0)){r.state.inLink=!0;const e={type:"link",raw:n,href:s,title:i,text:o,tokens:r.inlineTokens(o,[])};return r.state.inLink=!1,e}return{type:"image",raw:n,href:s,title:i,text:Er(o)}}class Ur{constructor(e){this.options=e||xr}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const e=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?e:Pr(e,"\n")}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const e=t[0],n=function(e,t){const n=e.match(/^(\s+)(?:```)/);if(null===n)return t;const r=n[1];return t.split("\n").map((e=>{const t=e.match(/^\s+/);if(null===t)return e;const[n]=t;return n.length>=r.length?e.slice(r.length):e})).join("\n")}(e,t[3]||"");return{type:"code",raw:e,lang:t[2]?t[2].trim():t[2],text:n}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let e=t[2].trim();if(/#$/.test(e)){const t=Pr(e,"#");this.options.pedantic?e=t.trim():t&&!/ $/.test(t)||(e=t.trim())}const n={type:"heading",raw:t[0],depth:t[1].length,text:e,tokens:[]};return this.lexer.inline(n.text,n.tokens),n}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){const e=t[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:t[0],tokens:this.lexer.blockTokens(e,[]),text:e}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n,r,s,i,o,a,l,u,c,p,h,f,d=t[1].trim();const g=d.length>1,m={type:"list",raw:"",ordered:g,start:g?+d.slice(0,-1):"",loose:!1,items:[]};d=g?`\\d{1,9}\\${d.slice(-1)}`:`\\${d}`,this.options.pedantic&&(d=g?d:"[*+-]");const x=new RegExp(`^( {0,3}${d})((?: [^\\n]*)?(?:\\n|$))`);for(;e&&(f=!1,t=x.exec(e))&&!this.rules.block.hr.test(e);){if(n=t[0],e=e.substring(n.length),u=t[2].split("\n",1)[0],c=e.split("\n",1)[0],this.options.pedantic?(i=2,h=u.trimLeft()):(i=t[2].search(/[^ ]/),i=i>4?1:i,h=u.slice(i),i+=t[1].length),a=!1,!u&&/^ *$/.test(c)&&(n+=c+"\n",e=e.substring(c.length+1),f=!0),!f){const t=new RegExp(`^ {0,${Math.min(3,i-1)}}(?:[*+-]|\\d{1,9}[.)])`);for(;e&&(p=e.split("\n",1)[0],u=p,this.options.pedantic&&(u=u.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!t.test(u));){if(u.search(/[^ ]/)>=i||!u.trim())h+="\n"+u.slice(i);else{if(a)break;h+="\n"+u}a||u.trim()||(a=!0),n+=p+"\n",e=e.substring(p.length+1)}}m.loose||(l?m.loose=!0:/\n *\n *$/.test(n)&&(l=!0)),this.options.gfm&&(r=/^\[[ xX]\] /.exec(h),r&&(s="[ ] "!==r[0],h=h.replace(/^\[[ xX]\] +/,""))),m.items.push({type:"list_item",raw:n,task:!!r,checked:s,loose:!1,text:h}),m.raw+=n}m.items[m.items.length-1].raw=n.trimRight(),m.items[m.items.length-1].text=h.trimRight(),m.raw=m.raw.trimRight();const y=m.items.length;for(o=0;o<y;o++){this.lexer.state.top=!1,m.items[o].tokens=this.lexer.blockTokens(m.items[o].text,[]);const e=m.items[o].tokens.filter((e=>"space"===e.type)),t=e.every((e=>{const t=e.raw.split("");let n=0;for(const e of t)if("\n"===e&&(n+=1),n>1)return!0;return!1}));!m.loose&&e.length&&t&&(m.loose=!0,m.items[o].loose=!0)}return m}}html(e){const t=this.rules.block.html.exec(e);if(t){const e={type:"html",raw:t[0],pre:!this.options.sanitizer&&("pre"===t[1]||"script"===t[1]||"style"===t[1]),text:t[0]};return this.options.sanitize&&(e.type="paragraph",e.text=this.options.sanitizer?this.options.sanitizer(t[0]):Er(t[0]),e.tokens=[],this.lexer.inline(e.text,e.tokens)),e}}def(e){const t=this.rules.block.def.exec(e);if(t){t[3]&&(t[3]=t[3].substring(1,t[3].length-1));return{type:"def",tag:t[1].toLowerCase().replace(/\s+/g," "),raw:t[0],href:t[2],title:t[3]}}}table(e){const t=this.rules.block.table.exec(e);if(t){const e={type:"table",header:Fr(t[1]).map((e=>({text:e}))),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:t[3]?t[3].replace(/\n[ \t]*$/,"").split("\n"):[]};if(e.header.length===e.align.length){e.raw=t[0];let n,r,s,i,o=e.align.length;for(n=0;n<o;n++)/^ *-+: *$/.test(e.align[n])?e.align[n]="right":/^ *:-+: *$/.test(e.align[n])?e.align[n]="center":/^ *:-+ *$/.test(e.align[n])?e.align[n]="left":e.align[n]=null;for(o=e.rows.length,n=0;n<o;n++)e.rows[n]=Fr(e.rows[n],e.header.length).map((e=>({text:e})));for(o=e.header.length,r=0;r<o;r++)e.header[r].tokens=[],this.lexer.inlineTokens(e.header[r].text,e.header[r].tokens);for(o=e.rows.length,r=0;r<o;r++)for(i=e.rows[r],s=0;s<i.length;s++)i[s].tokens=[],this.lexer.inlineTokens(i[s].text,i[s].tokens);return e}}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t){const e={type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:[]};return this.lexer.inline(e.text,e.tokens),e}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const e={type:"paragraph",raw:t[0],text:"\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1],tokens:[]};return this.lexer.inline(e.text,e.tokens),e}}text(e){const t=this.rules.block.text.exec(e);if(t){const e={type:"text",raw:t[0],text:t[0],tokens:[]};return this.lexer.inline(e.text,e.tokens),e}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:Er(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):Er(t[0]):t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const e=t[2].trim();if(!this.options.pedantic&&/^</.test(e)){if(!/>$/.test(e))return;const t=Pr(e.slice(0,-1),"\\");if((e.length-t.length)%2==0)return}else{const e=function(e,t){if(-1===e.indexOf(t[1]))return-1;const n=e.length;let r=0,s=0;for(;s<n;s++)if("\\"===e[s])s++;else if(e[s]===t[0])r++;else if(e[s]===t[1]&&(r--,r<0))return s;return-1}(t[2],"()");if(e>-1){const n=(0===t[0].indexOf("!")?5:4)+t[1].length+e;t[2]=t[2].substring(0,e),t[0]=t[0].substring(0,n).trim(),t[3]=""}}let n=t[2],r="";if(this.options.pedantic){const e=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(n);e&&(n=e[1],r=e[3])}else r=t[3]?t[3].slice(1,-1):"";return n=n.trim(),/^</.test(n)&&(n=this.options.pedantic&&!/>$/.test(e)?n.slice(1):n.slice(1,-1)),Dr(t,{href:n?n.replace(this.rules.inline._escapes,"$1"):n,title:r?r.replace(this.rules.inline._escapes,"$1"):r},t[0],this.lexer)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let e=(n[2]||n[1]).replace(/\s+/g," ");if(e=t[e.toLowerCase()],!e||!e.href){const e=n[0].charAt(0);return{type:"text",raw:e,text:e}}return Dr(n,e,n[0],this.lexer)}}emStrong(e,t,n=""){let r=this.rules.inline.emStrong.lDelim.exec(e);if(!r)return;if(r[3]&&n.match(/[\p{L}\p{N}]/u))return;const s=r[1]||r[2]||"";if(!s||s&&(""===n||this.rules.inline.punctuation.exec(n))){const n=r[0].length-1;let s,i,o=n,a=0;const l="*"===r[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(l.lastIndex=0,t=t.slice(-1*e.length+n);null!=(r=l.exec(t));){if(s=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!s)continue;if(i=s.length,r[3]||r[4]){o+=i;continue}if((r[5]||r[6])&&n%3&&!((n+i)%3)){a+=i;continue}if(o-=i,o>0)continue;if(i=Math.min(i,i+o+a),Math.min(n,i)%2){const t=e.slice(1,n+r.index+i);return{type:"em",raw:e.slice(0,n+r.index+i+1),text:t,tokens:this.lexer.inlineTokens(t,[])}}const t=e.slice(2,n+r.index+i-1);return{type:"strong",raw:e.slice(0,n+r.index+i+1),text:t,tokens:this.lexer.inlineTokens(t,[])}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let e=t[2].replace(/\n/g," ");const n=/[^ ]/.test(e),r=/^ /.test(e)&&/ $/.test(e);return n&&r&&(e=e.substring(1,e.length-1)),e=Er(e,!0),{type:"codespan",raw:t[0],text:e}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2],[])}}autolink(e,t){const n=this.rules.inline.autolink.exec(e);if(n){let e,r;return"@"===n[2]?(e=Er(this.options.mangle?t(n[1]):n[1]),r="mailto:"+e):(e=Er(n[1]),r=e),{type:"link",raw:n[0],text:e,href:r,tokens:[{type:"text",raw:e,text:e}]}}}url(e,t){let n;if(n=this.rules.inline.url.exec(e)){let e,r;if("@"===n[2])e=Er(this.options.mangle?t(n[0]):n[0]),r="mailto:"+e;else{let t;do{t=n[0],n[0]=this.rules.inline._backpedal.exec(n[0])[0]}while(t!==n[0]);e=Er(n[0]),r="www."===n[1]?"http://"+e:e}return{type:"link",raw:n[0],text:e,href:r,tokens:[{type:"text",raw:e,text:e}]}}}inlineText(e,t){const n=this.rules.inline.text.exec(e);if(n){let e;return e=this.lexer.state.inRawBlock?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(n[0]):Er(n[0]):n[0]:Er(this.options.smartypants?t(n[0]):n[0]),{type:"text",raw:n[0],text:e}}}}const Zr={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)( [^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,table:Lr,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\[\[\]]|[^\[\]])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};Zr.def=Or(Zr.def).replace("label",Zr._label).replace("title",Zr._title).getRegex(),Zr.bullet=/(?:[*+-]|\d{1,9}[.)])/,Zr.listItemStart=Or(/^( *)(bull) */).replace("bull",Zr.bullet).getRegex(),Zr.list=Or(Zr.list).replace(/bull/g,Zr.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+Zr.def.source+")").getRegex(),Zr._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Zr._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,Zr.html=Or(Zr.html,"i").replace("comment",Zr._comment).replace("tag",Zr._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Zr.paragraph=Or(Zr._paragraph).replace("hr",Zr.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Zr._tag).getRegex(),Zr.blockquote=Or(Zr.blockquote).replace("paragraph",Zr.paragraph).getRegex(),Zr.normal=Nr({},Zr),Zr.gfm=Nr({},Zr.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),Zr.gfm.table=Or(Zr.gfm.table).replace("hr",Zr.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Zr._tag).getRegex(),Zr.gfm.paragraph=Or(Zr._paragraph).replace("hr",Zr.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",Zr.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Zr._tag).getRegex(),Zr.pedantic=Nr({},Zr.normal,{html:Or("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",Zr._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Lr,paragraph:Or(Zr.normal._paragraph).replace("hr",Zr.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",Zr.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});const Vr={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:Lr,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(?!\s*\])((?:\\[\[\]]?|[^\[\]\\])+)\]/,nolink:/^!?\[(?!\s*\])((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^[^_*]*?\_\_[^_*]*?\*[^_*]*?(?=\_\_)|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?\_[^_*]*?(?=\*\*)|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:Lr,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};function Hr(e){return e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function Qr(e){let t,n,r="";const s=e.length;for(t=0;t<s;t++)n=e.charCodeAt(t),Math.random()>.5&&(n="x"+n.toString(16)),r+="&#"+n+";";return r}Vr._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",Vr.punctuation=Or(Vr.punctuation).replace(/punctuation/g,Vr._punctuation).getRegex(),Vr.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,Vr.escapedEmSt=/\\\*|\\_/g,Vr._comment=Or(Zr._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),Vr.emStrong.lDelim=Or(Vr.emStrong.lDelim).replace(/punct/g,Vr._punctuation).getRegex(),Vr.emStrong.rDelimAst=Or(Vr.emStrong.rDelimAst,"g").replace(/punct/g,Vr._punctuation).getRegex(),Vr.emStrong.rDelimUnd=Or(Vr.emStrong.rDelimUnd,"g").replace(/punct/g,Vr._punctuation).getRegex(),Vr._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,Vr._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,Vr._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,Vr.autolink=Or(Vr.autolink).replace("scheme",Vr._scheme).replace("email",Vr._email).getRegex(),Vr._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,Vr.tag=Or(Vr.tag).replace("comment",Vr._comment).replace("attribute",Vr._attribute).getRegex(),Vr._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Vr._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,Vr._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,Vr.link=Or(Vr.link).replace("label",Vr._label).replace("href",Vr._href).replace("title",Vr._title).getRegex(),Vr.reflink=Or(Vr.reflink).replace("label",Vr._label).getRegex(),Vr.reflinkSearch=Or(Vr.reflinkSearch,"g").replace("reflink",Vr.reflink).replace("nolink",Vr.nolink).getRegex(),Vr.normal=Nr({},Vr),Vr.pedantic=Nr({},Vr.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:Or(/^!?\[(label)\]\((.*?)\)/).replace("label",Vr._label).getRegex(),reflink:Or(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Vr._label).getRegex()}),Vr.gfm=Nr({},Vr.normal,{escape:Or(Vr.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),Vr.gfm.url=Or(Vr.gfm.url,"i").replace("email",Vr.gfm._extended_email).getRegex(),Vr.breaks=Nr({},Vr.gfm,{br:Or(Vr.br).replace("{2,}","*").getRegex(),text:Or(Vr.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});class Kr{constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||xr,this.options.tokenizer=this.options.tokenizer||new Ur,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:Zr.normal,inline:Vr.normal};this.options.pedantic?(t.block=Zr.pedantic,t.inline=Vr.pedantic):this.options.gfm&&(t.block=Zr.gfm,this.options.breaks?t.inline=Vr.breaks:t.inline=Vr.gfm),this.tokenizer.rules=t}static get rules(){return{block:Zr,inline:Vr}}static lex(e,t){return new Kr(t).lex(e)}static lexInline(e,t){return new Kr(t).inlineTokens(e)}lex(e){let t;for(e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    "),this.blockTokens(e,this.tokens);t=this.inlineQueue.shift();)this.inlineTokens(t.src,t.tokens);return this.tokens}blockTokens(e,t=[]){let n,r,s,i;for(this.options.pedantic&&(e=e.replace(/^ +$/gm,""));e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some((r=>!!(n=r.call({lexer:this},e,t))&&(e=e.substring(n.raw.length),t.push(n),!0)))))if(n=this.tokenizer.space(e))e=e.substring(n.raw.length),1===n.raw.length&&t.length>0?t[t.length-1].raw+="\n":t.push(n);else if(n=this.tokenizer.code(e))e=e.substring(n.raw.length),r=t[t.length-1],!r||"paragraph"!==r.type&&"text"!==r.type?t.push(n):(r.raw+="\n"+n.raw,r.text+="\n"+n.text,this.inlineQueue[this.inlineQueue.length-1].src=r.text);else if(n=this.tokenizer.fences(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.heading(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.hr(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.blockquote(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.list(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.html(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.def(e))e=e.substring(n.raw.length),r=t[t.length-1],!r||"paragraph"!==r.type&&"text"!==r.type?this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title}):(r.raw+="\n"+n.raw,r.text+="\n"+n.raw,this.inlineQueue[this.inlineQueue.length-1].src=r.text);else if(n=this.tokenizer.table(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.lheading(e))e=e.substring(n.raw.length),t.push(n);else{if(s=e,this.options.extensions&&this.options.extensions.startBlock){let t=1/0;const n=e.slice(1);let r;this.options.extensions.startBlock.forEach((function(e){r=e.call({lexer:this},n),"number"==typeof r&&r>=0&&(t=Math.min(t,r))})),t<1/0&&t>=0&&(s=e.substring(0,t+1))}if(this.state.top&&(n=this.tokenizer.paragraph(s)))r=t[t.length-1],i&&"paragraph"===r.type?(r.raw+="\n"+n.raw,r.text+="\n"+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(n),i=s.length!==e.length,e=e.substring(n.raw.length);else if(n=this.tokenizer.text(e))e=e.substring(n.raw.length),r=t[t.length-1],r&&"text"===r.type?(r.raw+="\n"+n.raw,r.text+="\n"+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(n);else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}return this.state.top=!0,t}inline(e,t){this.inlineQueue.push({src:e,tokens:t})}inlineTokens(e,t=[]){let n,r,s,i,o,a,l=e;if(this.tokens.links){const e=Object.keys(this.tokens.links);if(e.length>0)for(;null!=(i=this.tokenizer.rules.inline.reflinkSearch.exec(l));)e.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(l=l.slice(0,i.index)+"["+qr("a",i[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(i=this.tokenizer.rules.inline.blockSkip.exec(l));)l=l.slice(0,i.index)+"["+qr("a",i[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(i=this.tokenizer.rules.inline.escapedEmSt.exec(l));)l=l.slice(0,i.index)+"++"+l.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;e;)if(o||(a=""),o=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some((r=>!!(n=r.call({lexer:this},e,t))&&(e=e.substring(n.raw.length),t.push(n),!0)))))if(n=this.tokenizer.escape(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.tag(e))e=e.substring(n.raw.length),r=t[t.length-1],r&&"text"===n.type&&"text"===r.type?(r.raw+=n.raw,r.text+=n.text):t.push(n);else if(n=this.tokenizer.link(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.reflink(e,this.tokens.links))e=e.substring(n.raw.length),r=t[t.length-1],r&&"text"===n.type&&"text"===r.type?(r.raw+=n.raw,r.text+=n.text):t.push(n);else if(n=this.tokenizer.emStrong(e,l,a))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.codespan(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.br(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.del(e))e=e.substring(n.raw.length),t.push(n);else if(n=this.tokenizer.autolink(e,Qr))e=e.substring(n.raw.length),t.push(n);else if(this.state.inLink||!(n=this.tokenizer.url(e,Qr))){if(s=e,this.options.extensions&&this.options.extensions.startInline){let t=1/0;const n=e.slice(1);let r;this.options.extensions.startInline.forEach((function(e){r=e.call({lexer:this},n),"number"==typeof r&&r>=0&&(t=Math.min(t,r))})),t<1/0&&t>=0&&(s=e.substring(0,t+1))}if(n=this.tokenizer.inlineText(s,Hr))e=e.substring(n.raw.length),"_"!==n.raw.slice(-1)&&(a=n.raw.slice(-1)),o=!0,r=t[t.length-1],r&&"text"===r.type?(r.raw+=n.raw,r.text+=n.text):t.push(n);else if(e){const t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}else e=e.substring(n.raw.length),t.push(n);return t}}class Gr{constructor(e){this.options=e||xr}code(e,t,n){const r=(t||"").match(/\S*/)[0];if(this.options.highlight){const t=this.options.highlight(e,r);null!=t&&t!==e&&(n=!0,e=t)}return e=e.replace(/\n$/,"")+"\n",r?'<pre><code class="'+this.options.langPrefix+Er(r,!0)+'">'+(n?e:Er(e,!0))+"</code></pre>\n":"<pre><code>"+(n?e:Er(e,!0))+"</code></pre>\n"}blockquote(e){return"<blockquote>\n"+e+"</blockquote>\n"}html(e){return e}heading(e,t,n,r){return this.options.headerIds?"<h"+t+' id="'+this.options.headerPrefix+r.slug(n)+'">'+e+"</h"+t+">\n":"<h"+t+">"+e+"</h"+t+">\n"}hr(){return this.options.xhtml?"<hr/>\n":"<hr>\n"}list(e,t,n){const r=t?"ol":"ul";return"<"+r+(t&&1!==n?' start="'+n+'"':"")+">\n"+e+"</"+r+">\n"}listitem(e){return"<li>"+e+"</li>\n"}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(e){return"<p>"+e+"</p>\n"}table(e,t){return t&&(t="<tbody>"+t+"</tbody>"),"<table>\n<thead>\n"+e+"</thead>\n"+t+"</table>\n"}tablerow(e){return"<tr>\n"+e+"</tr>\n"}tablecell(e,t){const n=t.header?"th":"td";return(t.align?"<"+n+' align="'+t.align+'">':"<"+n+">")+e+"</"+n+">\n"}strong(e){return"<strong>"+e+"</strong>"}em(e){return"<em>"+e+"</em>"}codespan(e){return"<code>"+e+"</code>"}br(){return this.options.xhtml?"<br/>":"<br>"}del(e){return"<del>"+e+"</del>"}link(e,t,n){if(null===(e=Cr(this.options.sanitize,this.options.baseUrl,e)))return n;let r='<a href="'+Er(e)+'"';return t&&(r+=' title="'+t+'"'),r+=">"+n+"</a>",r}image(e,t,n){if(null===(e=Cr(this.options.sanitize,this.options.baseUrl,e)))return n;let r='<img src="'+e+'" alt="'+n+'"';return t&&(r+=' title="'+t+'"'),r+=this.options.xhtml?"/>":">",r}text(e){return e}}class Jr{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,n){return""+n}image(e,t,n){return""+n}br(){return""}}class Xr{constructor(){this.seen={}}serialize(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(e,t){let n=e,r=0;if(this.seen.hasOwnProperty(n)){r=this.seen[e];do{r++,n=e+"-"+r}while(this.seen.hasOwnProperty(n))}return t||(this.seen[e]=r,this.seen[n]=0),n}slug(e,t={}){const n=this.serialize(e);return this.getNextSafeSlug(n,t.dryrun)}}class Wr{constructor(e){this.options=e||xr,this.options.renderer=this.options.renderer||new Gr,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Jr,this.slugger=new Xr}static parse(e,t){return new Wr(t).parse(e)}static parseInline(e,t){return new Wr(t).parseInline(e)}parse(e,t=!0){let n,r,s,i,o,a,l,u,c,p,h,f,d,g,m,x,y,w,b,k="";const v=e.length;for(n=0;n<v;n++)if(p=e[n],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[p.type]&&(b=this.options.extensions.renderers[p.type].call({parser:this},p),!1!==b||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(p.type)))k+=b||"";else switch(p.type){case"space":continue;case"hr":k+=this.renderer.hr();continue;case"heading":k+=this.renderer.heading(this.parseInline(p.tokens),p.depth,Sr(this.parseInline(p.tokens,this.textRenderer)),this.slugger);continue;case"code":k+=this.renderer.code(p.text,p.lang,p.escaped);continue;case"table":for(u="",l="",i=p.header.length,r=0;r<i;r++)l+=this.renderer.tablecell(this.parseInline(p.header[r].tokens),{header:!0,align:p.align[r]});for(u+=this.renderer.tablerow(l),c="",i=p.rows.length,r=0;r<i;r++){for(a=p.rows[r],l="",o=a.length,s=0;s<o;s++)l+=this.renderer.tablecell(this.parseInline(a[s].tokens),{header:!1,align:p.align[s]});c+=this.renderer.tablerow(l)}k+=this.renderer.table(u,c);continue;case"blockquote":c=this.parse(p.tokens),k+=this.renderer.blockquote(c);continue;case"list":for(h=p.ordered,f=p.start,d=p.loose,i=p.items.length,c="",r=0;r<i;r++)m=p.items[r],x=m.checked,y=m.task,g="",m.task&&(w=this.renderer.checkbox(x),d?m.tokens.length>0&&"paragraph"===m.tokens[0].type?(m.tokens[0].text=w+" "+m.tokens[0].text,m.tokens[0].tokens&&m.tokens[0].tokens.length>0&&"text"===m.tokens[0].tokens[0].type&&(m.tokens[0].tokens[0].text=w+" "+m.tokens[0].tokens[0].text)):m.tokens.unshift({type:"text",text:w}):g+=w),g+=this.parse(m.tokens,d),c+=this.renderer.listitem(g,y,x);k+=this.renderer.list(c,h,f);continue;case"html":k+=this.renderer.html(p.text);continue;case"paragraph":k+=this.renderer.paragraph(this.parseInline(p.tokens));continue;case"text":for(c=p.tokens?this.parseInline(p.tokens):p.text;n+1<v&&"text"===e[n+1].type;)p=e[++n],c+="\n"+(p.tokens?this.parseInline(p.tokens):p.text);k+=t?this.renderer.paragraph(c):c;continue;default:{const e='Token with "'+p.type+'" type was not found.';if(this.options.silent)return void console.error(e);throw new Error(e)}}return k}parseInline(e,t){t=t||this.renderer;let n,r,s,i="";const o=e.length;for(n=0;n<o;n++)if(r=e[n],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[r.type]&&(s=this.options.extensions.renderers[r.type].call({parser:this},r),!1!==s||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(r.type)))i+=s||"";else switch(r.type){case"escape":case"text":i+=t.text(r.text);break;case"html":i+=t.html(r.text);break;case"link":i+=t.link(r.href,r.title,this.parseInline(r.tokens,t));break;case"image":i+=t.image(r.href,r.title,r.text);break;case"strong":i+=t.strong(this.parseInline(r.tokens,t));break;case"em":i+=t.em(this.parseInline(r.tokens,t));break;case"codespan":i+=t.codespan(r.text);break;case"br":i+=t.br();break;case"del":i+=t.del(this.parseInline(r.tokens,t));break;default:{const e='Token with "'+r.type+'" type was not found.';if(this.options.silent)return void console.error(e);throw new Error(e)}}return i}}function Yr(e,t,n){if(null==e)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");if("function"==typeof t&&(n=t,t=null),Br(t=Nr({},Yr.defaults,t||{})),n){const r=t.highlight;let s;try{s=Kr.lex(e,t)}catch(e){return n(e)}const i=function(e){let i;if(!e)try{t.walkTokens&&Yr.walkTokens(s,t.walkTokens),i=Wr.parse(s,t)}catch(t){e=t}return t.highlight=r,e?n(e):n(null,i)};if(!r||r.length<3)return i();if(delete t.highlight,!s.length)return i();let o=0;return Yr.walkTokens(s,(function(e){"code"===e.type&&(o++,setTimeout((()=>{r(e.text,e.lang,(function(t,n){if(t)return i(t);null!=n&&n!==e.text&&(e.text=n,e.escaped=!0),o--,0===o&&i()}))}),0))})),void(0===o&&i())}try{const n=Kr.lex(e,t);return t.walkTokens&&Yr.walkTokens(n,t.walkTokens),Wr.parse(n,t)}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",t.silent)return"<p>An error occurred:</p><pre>"+Er(e.message+"",!0)+"</pre>";throw e}}function es(e){const t=t=>{!e||e.contains(t.target)||t.defaultPrevented||e.dispatchEvent(new CustomEvent("click_outside",e))};return document.addEventListener("click",t,!0),{destroy(){document.removeEventListener("click",t,!0)}}}function ts(e,t,n){const r=e.slice();return r[14]=t[n],r}function ns(e,t,n){const r=e.slice();return r[17]=t[n],r[18]=t,r[19]=n,r}function rs(e){let t,n=e[3],r=[];for(let t=0;t<n.length;t+=1)r[t]=is(ns(e,n,t));return{c(){t=p("ul");for(let e=0;e<r.length;e+=1)r[e].c();m(t,"class","mb-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base ring-1 ring-black ring-opacity-5 overflow-auto focus:outline-none sm:text-sm"),m(t,"tabindex","-1"),m(t,"role","listbox"),m(t,"aria-labelledby","listbox-label"),m(t,"aria-activedescendant","listbox-option-3")},m(e,n){l(e,t,n);for(let e=0;e<r.length;e+=1)r[e].m(t,null)},p(e,s){if(24&s){let i;for(n=e[3],i=0;i<n.length;i+=1){const o=ns(e,n,i);r[i]?r[i].p(o,s):(r[i]=is(o),r[i].c(),r[i].m(t,null))}for(;i<r.length;i+=1)r[i].d(1);r.length=n.length}},d(e){e&&u(t),c(r,e)}}}function ss(e){let t,n;return{c(){t=h("svg"),n=h("path"),m(n,"fill-rule","evenodd"),m(n,"d","M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"),m(n,"clip-rule","evenodd"),m(t,"class","h-5 w-5"),m(t,"xmlns","http://www.w3.org/2000/svg"),m(t,"viewBox","0 0 20 20"),m(t,"fill","currentColor"),m(t,"aria-hidden","true")},m(e,r){l(e,t,r),a(t,n)},d(e){e&&u(t)}}}function is(e){let t,n,r,i,o,c,h,y,w=e[17].value+"",k=e[17].selected&&ss();function v(){return e[8](e[17],e[18],e[19])}function A(){return e[9](e[17],e[18],e[19])}function E(){return e[10](e[19])}return{c(){t=p("li"),n=p("span"),r=f(w),i=d(),o=p("span"),k&&k.c(),c=d(),m(n,"class","font-normal block truncate"),b(n,"font-semibold",e[17].selected),m(o,"class","text-gray-600 absolute inset-y-0 left-0 flex items-center pl-1.5"),b(o,"text-white",!0===e[17].highlighted),m(t,"class","text-gray-900 cursor-default select-none relative py-2 pl-8 pr-4 svelte-n5we1s"),m(t,"id","listbox-option-0"),m(t,"role","option"),b(t,"highlightedOption",!0===e[17].highlighted)},m(e,s){l(e,t,s),a(t,n),a(n,r),a(t,i),a(t,o),k&&k.m(o,null),a(t,c),h||(y=[g(t,"mouseenter",v),g(t,"mouseleave",A),g(t,"click",E)],h=!0)},p(s,i){e=s,8&i&&w!==(w=e[17].value+"")&&x(r,w),8&i&&b(n,"font-semibold",e[17].selected),e[17].selected?k||(k=ss(),k.c(),k.m(o,null)):k&&(k.d(1),k=null),8&i&&b(o,"text-white",!0===e[17].highlighted),8&i&&b(t,"highlightedOption",!0===e[17].highlighted)},d(e){e&&u(t),k&&k.d(),h=!1,s(y)}}}function os(e){let t,n,r,s,i,o,c,h,y=e[1][e[14]]+"";function w(){return e[11](e[14])}return{c(){t=p("li"),n=p("span"),r=f(y),s=d(),i=p("span"),i.innerHTML='<svg class="fill-current h-6 w-6 " role="button" viewBox="0 0 20 20"><path d="M14.348,14.849c-0.469,0.469-1.229,0.469-1.697,0L10,11.819l-2.651,3.029c-0.469,0.469-1.229,0.469-1.697,0\n                                           c-0.469-0.469-0.469-1.229,0-1.697l2.758-3.15L5.651,6.849c-0.469-0.469-0.469-1.228,0-1.697s1.228-0.469,1.697,0L10,8.183\n                                           l2.651-3.031c0.469-0.469,1.228-0.469,1.697,0s0.469,1.229,0,1.697l-2.758,3.152l2.758,3.15\n                                           C14.817,13.62,14.817,14.38,14.348,14.849z"></path></svg>',o=d(),m(n,"class","font-normal block truncate"),m(i,"class","text-gray-600 absolute inset-y-0 left-0 flex items-center pl-1.5"),m(t,"class","text-gray-900 cursor-default block select-none relative py-1 pl-8 pr-4"),m(t,"id","listbox-option-0"),m(t,"role","option")},m(e,u){l(e,t,u),a(t,n),a(n,r),a(t,s),a(t,i),a(t,o),c||(h=g(i,"click",w),c=!0)},p(t,n){e=t,3&n&&y!==(y=e[1][e[14]]+"")&&x(r,y)},d(e){e&&u(t),c=!1,h()}}}function as(e){let t;return{c(){t=p("div"),t.textContent="Select one or more options",m(t,"class","flex-1 text-gray-800 h-full w-full p-1 px-2 pl-3")},m(e,n){l(e,t,n)},d(e){e&&u(t)}}}function ls(e){let t;return{c(){t=p("span"),t.innerHTML='<svg class="h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>',m(t,"class","absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none")},m(e,n){l(e,t,n)},d(e){e&&u(t)}}}function us(e){let n,r,s;return{c(){n=p("button"),n.textContent="Done",m(n,"class","mt-3 w-full inline-flex items-center justify-center px-4 py-2 border border-transparent shadow-sm font-medium rounded-md text-white bg-primary-color hover:bg-hover-color focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-color")},m(t,i){l(t,n,i),r||(s=g(n,"click",e[6]),r=!0)},p:t,d(e){e&&u(n),r=!1,s()}}}function cs(e){let n,r,o,h,f,x,y,w,b,k=e[2]&&rs(e),v=e[0],A=[];for(let t=0;t<v.length;t+=1)A[t]=os(ts(e,v,t));let E=0===e[0].length&&as(),_=!e[2]&&0===e[0].length&&ls(),S=0!==e[0].length&&us(e);return{c(){n=p("div"),k&&k.c(),r=d(),o=p("button"),h=p("ul");for(let e=0;e<A.length;e+=1)A[e].c();f=d(),E&&E.c(),x=d(),_&&_.c(),y=d(),S&&S.c(),m(h,"class","bg-white max-h-60 py-0 text-base overflow-auto focus:outline-none sm:text-sm"),m(h,"tabindex","-1"),m(h,"role","listbox"),m(h,"aria-labelledby","listbox-label"),m(h,"aria-activedescendant","listbox-option-3"),m(o,"type","button"),m(o,"class","w-full bg-white border border-gray-300 rounded-md shadow-sm pr-10 py-2 text-left cursor-default focus:outline-none focus:ring-1 focus:ring-primary-color focus:border-gray-500 sm:text-sm"),m(o,"aria-haspopup","listbox"),m(o,"aria-expanded","true"),m(o,"aria-labelledby","listbox-label"),m(n,"class","mt-1 relative sm:max-w-xs flex flex-col")},m(s,u){l(s,n,u),k&&k.m(n,null),a(n,r),a(n,o),a(o,h);for(let e=0;e<A.length;e+=1)A[e].m(h,null);var c;a(o,f),E&&E.m(o,null),a(o,x),_&&_.m(o,null),a(n,y),S&&S.m(n,null),w||(b=[g(o,"click",e[12]),(c=es.call(null,n),c&&i(c.destroy)?c.destroy:t),g(n,"click_outside",e[7])],w=!0)},p(e,[t]){if(e[2]?k?k.p(e,t):(k=rs(e),k.c(),k.m(n,r)):k&&(k.d(1),k=null),35&t){let n;for(v=e[0],n=0;n<v.length;n+=1){const r=ts(e,v,n);A[n]?A[n].p(r,t):(A[n]=os(r),A[n].c(),A[n].m(h,null))}for(;n<A.length;n+=1)A[n].d(1);A.length=v.length}0===e[0].length?E||(E=as(),E.c(),E.m(o,x)):E&&(E.d(1),E=null),e[2]||0!==e[0].length?_&&(_.d(1),_=null):_||(_=ls(),_.c(),_.m(o,null)),0!==e[0].length?S?S.p(e,t):(S=us(e),S.c(),S.m(n,null)):S&&(S.d(1),S=null)},i:t,o:t,d(e){e&&u(n),k&&k.d(),c(A,e),E&&E.d(),_&&_.d(),S&&S.d(),w=!1,s(b)}}}function ps(e,t,n){const r=E();let{selectedReplyIndexes:s=[]}=t,{replyOptions:i}=t,o=!1;const a=i.map(((e,t)=>({value:e,selected:!1})));function l(e){a[e].selected?u(e):(s.push(e),n(0,s),n(3,a[e].selected=!0,a),n(3,a))}function u(e){s.splice(s.indexOf(e),1),n(0,s),n(3,a[e].selected=!1,a),n(3,a),console.log(`removed ${e}`),console.log(s.length)}return e.$$set=e=>{"selectedReplyIndexes"in e&&n(0,s=e.selectedReplyIndexes),"replyOptions"in e&&n(1,i=e.replyOptions)},[s,i,o,a,l,u,function(){r("message",s)},function(e){n(2,o=!1)},(e,t,r)=>n(3,t[r].highlighted=!0,a),(e,t,r)=>n(3,t[r].highlighted=!1,a),e=>l(e),e=>u(e),()=>n(2,o=!o)]}Yr.options=Yr.setOptions=function(e){var t;return Nr(Yr.defaults,e),t=Yr.defaults,xr=t,Yr},Yr.getDefaults=mr,Yr.defaults=xr,Yr.use=function(...e){const t=Nr({},...e),n=Yr.defaults.extensions||{renderers:{},childTokens:{}};let r;e.forEach((e=>{if(e.extensions&&(r=!0,e.extensions.forEach((e=>{if(!e.name)throw new Error("extension name required");if(e.renderer){const t=n.renderers?n.renderers[e.name]:null;n.renderers[e.name]=t?function(...n){let r=e.renderer.apply(this,n);return!1===r&&(r=t.apply(this,n)),r}:e.renderer}if(e.tokenizer){if(!e.level||"block"!==e.level&&"inline"!==e.level)throw new Error("extension level must be 'block' or 'inline'");n[e.level]?n[e.level].unshift(e.tokenizer):n[e.level]=[e.tokenizer],e.start&&("block"===e.level?n.startBlock?n.startBlock.push(e.start):n.startBlock=[e.start]:"inline"===e.level&&(n.startInline?n.startInline.push(e.start):n.startInline=[e.start]))}e.childTokens&&(n.childTokens[e.name]=e.childTokens)}))),e.renderer){const n=Yr.defaults.renderer||new Gr;for(const t in e.renderer){const r=n[t];n[t]=(...s)=>{let i=e.renderer[t].apply(n,s);return!1===i&&(i=r.apply(n,s)),i}}t.renderer=n}if(e.tokenizer){const n=Yr.defaults.tokenizer||new Ur;for(const t in e.tokenizer){const r=n[t];n[t]=(...s)=>{let i=e.tokenizer[t].apply(n,s);return!1===i&&(i=r.apply(n,s)),i}}t.tokenizer=n}if(e.walkTokens){const n=Yr.defaults.walkTokens;t.walkTokens=function(t){e.walkTokens.call(this,t),n&&n.call(this,t)}}r&&(t.extensions=n),Yr.setOptions(t)}))},Yr.walkTokens=function(e,t){for(const n of e)switch(t.call(Yr,n),n.type){case"table":for(const e of n.header)Yr.walkTokens(e.tokens,t);for(const e of n.rows)for(const n of e)Yr.walkTokens(n.tokens,t);break;case"list":Yr.walkTokens(n.items,t);break;default:Yr.defaults.extensions&&Yr.defaults.extensions.childTokens&&Yr.defaults.extensions.childTokens[n.type]?Yr.defaults.extensions.childTokens[n.type].forEach((function(e){Yr.walkTokens(n[e],t)})):n.tokens&&Yr.walkTokens(n.tokens,t)}},Yr.parseInline=function(e,t){if(null==e)throw new Error("marked.parseInline(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");Br(t=Nr({},Yr.defaults,t||{}));try{const n=Kr.lexInline(e,t);return t.walkTokens&&Yr.walkTokens(n,t.walkTokens),Wr.parseInline(n,t)}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",t.silent)return"<p>An error occurred:</p><pre>"+Er(e.message+"",!0)+"</pre>";throw e}},Yr.Parser=Wr,Yr.parser=Wr.parse,Yr.Renderer=Gr,Yr.TextRenderer=Jr,Yr.Lexer=Kr,Yr.lexer=Kr.lex,Yr.Tokenizer=Ur,Yr.Slugger=Xr,Yr.parse=Yr,Wr.parse,Kr.lex;class hs extends Q{constructor(e){super(),H(this,e,ps,cs,o,{selectedReplyIndexes:0,replyOptions:1})}}function fs(e,t,n){const r=e.slice();return r[38]=t[n],r[40]=n,r}function ds(e,t,n){const r=e.slice();return r[38]=t[n],r[40]=n,r}function gs(e,t,n){const r=e.slice();return r[42]=t[n].slot,r[43]=t[n].userReplyValues,r[45]=n,r}function ms(e){let n;return{c(){n=p("h2"),n.textContent="Unknown error"},m(e,t){l(e,n,t)},p:t,i:t,o:t,d(e){e&&u(n)}}}function xs(e){let n;return{c(){n=p("button"),n.innerHTML='<svg class="animate-spin h-5 w-5 mr-3" viewBox="0 0 24 24"></svg>\n    Loading',m(n,"type","button"),m(n,"class","bg-primary-600"),n.disabled=!0},m(e,t){l(e,n,t)},p:t,i:t,o:t,d(e){e&&u(n)}}}function ys(e){return{c:t,m:t,p:t,i:t,o:t,d:t}}function ws(e){let n,r,s;return{c(){n=p("h2"),r=f("Bot failed to load: "),s=f(e[9]),m(n,"class","text-gray text-lg")},m(e,t){l(e,n,t),a(n,r),a(n,s)},p(e,t){512&t[0]&&x(s,e[9])},i:t,o:t,d(e){e&&u(n)}}}function bs(e){let t,n,r,s,i,o,h,f,g,x,y,w,b,k,v,A=Yr(e[8])+"",E=Yr(e[1][e[1].length-1].slot.ask)+"",_=e[1].slice(0,-1),S=[];for(let t=0;t<_.length;t+=1)S[t]=vs(gs(e,_,t));const $=[Os,$s,Ss,_s,Es,As],O=[];function T(e,t){return e[4]===nr.diagnostic||e[4]===nr.single&&e[2][0]===er[0]?0:e[4]===nr.single?1:e[4]===nr.multiple?2:"freeTextEntry"===e[4]?3:e[4]===nr.endConversation?4:"answer"!==e[4]?5:-1}~(w=T(e))&&(b=O[w]=$[w](e));let M=e[13]&&function(e){let t,n,r;return{c(){t=p("hr"),n=d(),r=p("div"),m(t,"class","mt-4")},m(e,s){l(e,t,s),l(e,n,s),l(e,r,s)},d(e){e&&u(t),e&&u(n),e&&u(r)}}}();return{c(){t=p("div"),n=p("div"),r=p("div"),s=d();for(let e=0;e<S.length;e+=1)S[e].c();i=d(),o=p("div"),h=p("div"),f=p("p"),g=d(),x=p("div"),y=p("div"),b&&b.c(),k=d(),M&&M.c(),m(r,"id","frameIntroduction"),m(n,"id","conversationHistory"),m(n,"class","flex flex-col space-y-4 mb-4"),m(f,"class","text-l"),m(h,"id","currentAsk"),m(h,"class","mr-4 sm:mr-12"),m(y,"id","user-reply-div"),m(y,"class","sm:ml-6 mt-2"),m(x,"id","currentUserReply"),m(o,"id","currentRound"),m(o,"class","sm:space-y-5 bg-white border-solid border border-gray-200 rounded-lg p-3"),m(t,"id","botContainer"),m(t,"class","container mx-auto border bg-container-color rounded p-2 sm:p-6 w-auto max-w-xl")},m(e,u){l(e,t,u),a(t,n),a(n,r),r.innerHTML=A,a(n,s);for(let e=0;e<S.length;e+=1)S[e].m(n,null);a(t,i),a(t,o),a(o,h),a(h,f),f.innerHTML=E,a(o,g),a(o,x),a(x,y),~w&&O[w].m(y,null),a(t,k),M&&M.m(t,null),v=!0},p(e,t){if((!v||256&t[0])&&A!==(A=Yr(e[8])+"")&&(r.innerHTML=A),65538&t[0]){let r;for(_=e[1].slice(0,-1),r=0;r<_.length;r+=1){const s=gs(e,_,r);S[r]?S[r].p(s,t):(S[r]=vs(s),S[r].c(),S[r].m(n,null))}for(;r<S.length;r+=1)S[r].d(1);S.length=_.length}(!v||2&t[0])&&E!==(E=Yr(e[1][e[1].length-1].slot.ask)+"")&&(f.innerHTML=E);let s=w;w=T(e),w===s?~w&&O[w].p(e,t):(b&&(B(),U(O[s],1,1,(()=>{O[s]=null})),q()),~w?(b=O[w],b?b.p(e,t):(b=O[w]=$[w](e),b.c()),D(b,1),b.m(y,null)):b=null)},i(e){v||(D(b),v=!0)},o(e){U(b),v=!1},d(e){e&&u(t),c(S,e),~w&&O[w].d(),M&&M.d()}}}function ks(e){let t,n,r,s,i,o,c,y,w=e[43].join(", ")+"";function b(){return e[24](e[45])}return{c(){t=p("div"),n=p("p"),r=f(w),s=d(),i=h("svg"),o=h("path"),m(o,"d","M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"),m(i,"xmlns","http://www.w3.org/2000/svg"),m(i,"class","inline-block ml-3 h-5 w-5 text-gray-400 hover:text-gray-800"),m(i,"viewBox","0 0 20 20"),m(i,"fill","currentColor"),m(n,"class","mx-4 border-b-2 border-gray-300 text-base inline-block hover:text-gray-800"),m(t,"id","user-reply-buttons-completed"),m(t,"class","mt-2")},m(e,u){l(e,t,u),a(t,n),a(n,r),a(n,s),a(n,i),a(i,o),c||(y=g(n,"click",b),c=!0)},p(t,n){e=t,2&n[0]&&w!==(w=e[43].join(", ")+"")&&x(r,w)},d(e){e&&u(t),c=!1,y()}}}function vs(e){let t,n,r,s,i=Yr(e[42].ask)+"",o=e[43].length>0&&ks(e);return{c(){t=p("div"),n=p("p"),r=d(),o&&o.c(),s=d(),m(n,"id","bot-ask-text-completed"),m(n,"class","text-l mr-4 sm:mr-12 "),m(t,"class","flex flex-col text-gray-400 bg-white border-solid border border-gray-200 rounded-lg p-3")},m(e,u){l(e,t,u),a(t,n),n.innerHTML=i,a(t,r),o&&o.m(t,null),a(t,s)},p(e,r){2&r[0]&&i!==(i=Yr(e[42].ask)+"")&&(n.innerHTML=i),e[43].length>0?o?o.p(e,r):(o=ks(e),o.c(),o.m(t,s)):o&&(o.d(1),o=null)},d(e){e&&u(t),o&&o.d()}}}function As(e){let n,r,s,i;return{c(){n=p("p"),r=f("Error: unsupported reply type of "),s=f(e[4]),i=f(" received"),m(n,"class","my-2")},m(e,t){l(e,n,t),a(n,r),a(n,s),a(n,i)},p(e,t){16&t[0]&&x(s,e[4])},i:t,o:t,d(e){e&&u(n)}}}function Es(e){let n;return{c(){n=p("p"),n.textContent="End of conversation",m(n,"class","my-2")},m(e,t){l(e,n,t)},p:t,i:t,o:t,d(e){e&&u(n)}}}function _s(e){let n,r,i,o,c,h,w,b,k,v,A;return{c(){n=p("div"),r=p("input"),i=d(),o=p("button"),o.textContent="Go",c=d(),h=p("span"),h.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"></path></svg>',w=d(),b=p("p"),k=f(e[7]),m(r,"type","text"),m(r,"size","50"),m(h,"class","askIcon"),m(n,"class","my-2")},m(t,s){l(t,n,s),a(n,r),y(r,e[6]),a(n,i),a(n,o),a(n,c),a(n,h),a(n,w),a(n,b),a(b,k),v||(A=[g(r,"input",e[28]),g(r,"keyup",e[29]),g(o,"click",e[18]),g(h,"click",e[30])],v=!0)},p(e,t){64&t[0]&&r.value!==e[6]&&y(r,e[6]),128&t[0]&&x(k,e[7])},i:t,o:t,d(e){e&&u(n),v=!1,s(A)}}}function Ss(e){let t,n;return t=new hs({props:{replyOptions:e[2]}}),t.$on("message",e[15]),{c(){!function(e){e&&e.c()}(t.$$.fragment)},m(e,r){Z(t,e,r),n=!0},p(e,n){const r={};4&n[0]&&(r.replyOptions=e[2]),t.$set(r)},i(e){n||(D(t.$$.fragment,e),n=!0)},o(e){U(t.$$.fragment,e),n=!1},d(e){V(t,e)}}}function $s(e){let n,r,i,o,h,f,x,y=e[2],b=[];for(let t=0;t<y.length;t+=1)b[t]=Ts(fs(e,y,t));return{c(){n=p("div"),r=p("div"),i=p("select");for(let e=0;e<b.length;e+=1)b[e].c();o=d(),h=p("button"),h.textContent="Done",m(i,"class","block w-full pl-2 pr-10 text-base font-medium border-gray-300 focus:outline-none focus:ring-primary-color sm:text-sm rounded-md"),void 0===e[5]&&z((()=>e[26].call(i))),m(r,"class","w-full sm:max-w-xs"),m(h,"type","button"),m(h,"class","mt-3 w-full inline-flex items-center justify-center px-4 py-2 border border-transparent font-medium rounded-md sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm shadow-sm text-white bg-primary-color hover:bg-hover-color focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-hover-color"),m(n,"class","sm:flex sm:items-center")},m(t,s){l(t,n,s),a(n,r),a(r,i);for(let e=0;e<b.length;e+=1)b[e].m(i,null);w(i,e[5]),a(n,o),a(n,h),f||(x=[g(i,"change",e[26]),g(h,"click",e[27])],f=!0)},p(e,t){if(4&t[0]){let n;for(y=e[2],n=0;n<y.length;n+=1){const r=fs(e,y,n);b[n]?b[n].p(r,t):(b[n]=Ts(r),b[n].c(),b[n].m(i,null))}for(;n<b.length;n+=1)b[n].d(1);b.length=y.length}32&t[0]&&w(i,e[5])},i:t,o:t,d(e){e&&u(n),c(b,e),f=!1,s(x)}}}function Os(e){let n,r,s=e[17](e[2]),i=[];for(let t=0;t<s.length;t+=1)i[t]=Ms(ds(e,s,t));return{c(){n=p("div"),r=p("div");for(let e=0;e<i.length;e+=1)i[e].c();m(r,"class","w-full sm:max-w-xs"),m(n,"class","sm:flex sm:items-center")},m(e,t){l(e,n,t),a(n,r);for(let e=0;e<i.length;e+=1)i[e].m(r,null)},p(e,t){if(147460&t[0]){let n;for(s=e[17](e[2]),n=0;n<s.length;n+=1){const o=ds(e,s,n);i[n]?i[n].p(o,t):(i[n]=Ms(o),i[n].c(),i[n].m(r,null))}for(;n<i.length;n+=1)i[n].d(1);i.length=s.length}},i:t,o:t,d(e){e&&u(n),c(i,e)}}}function Ts(e){let t,n,r,s=e[38]+"";return{c(){t=p("option"),n=f(s),t.__value=r=e[40],t.value=t.__value},m(e,r){l(e,t,r),a(t,n)},p(e,t){4&t[0]&&s!==(s=e[38]+"")&&x(n,s)},d(e){e&&u(t)}}}function Ms(e){let t,n,r,s,i,o,c=e[38]+"";function h(){return e[25](e[38],e[40])}return{c(){t=p("button"),n=f(c),r=d(),m(t,"type","button"),m(t,"class","w-full inline-flex items-center justify-center px-4 py-2 border border-transparent font-medium rounded-md sm:w-auto sm:text-sm shadow-sm text-white bg-primary-color hover:bg-hover-color focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-hover-color"),m(t,"id",s="reply-"+e[40])},m(e,s){l(e,t,s),a(t,n),a(t,r),i||(o=g(t,"click",h),i=!0)},p(t,r){e=t,4&r[0]&&c!==(c=e[38]+"")&&x(n,c)},d(e){e&&u(t),i=!1,o()}}}function Cs(e){let t,n,r,s;const i=[bs,ws,ys,xs,ms],o=[];function a(e,t){return e[10]&&!e[12]?0:e[12]?1:e[0]?2:e[11]?3:4}return t=a(e),n=o[t]=i[t](e),{c(){n.c(),r=f("")},m(e,n){o[t].m(e,n),l(e,r,n),s=!0},p(e,s){let l=t;t=a(e),t===l?o[t].p(e,s):(B(),U(o[l],1,1,(()=>{o[l]=null})),q(),n=o[t],n?n.p(e,s):(n=o[t]=i[t](e),n.c()),D(n,1),n.m(r.parentNode,r))},i(e){s||(D(n),s=!0)},o(e){U(n),s=!1},d(e){o[t].d(e),e&&u(r)}}}function Rs(e={}){const t=document.getElementById("botContainer");t.style.setProperty("--primary-color",e.primaryColor),t.style.setProperty("--secondary-color",e.secondaryColor),t.style.setProperty("--hover-color",e.hoverColor),t.style.setProperty("--container-color",e.containerBg),t.style.setProperty("--container-border-color",e.containerBorderBg),t.style.fontFamily=e.customerFont}function zs(e,t,n){let r,s,i,o,a,l,{propBotConfig:u=null}=t,{propGetConfigFromRemote:c=!1}=t,{localStorageKey:p}=t,{waitForStartNewConversation:h=!1}=t,f="",d="",g="",m="",x=!h,y=!1,w=!1,b=!!u,k=null;function v(e,t,r,s){return e&&X(e.version)?(function(e,t){let n=JSON.stringify(e);localStorage.setItem(t,n)}(e,r),k=e.startFrameId,e):(s||n(11,y=!0),e=G(!1,t,r,s),n(11,y=!1),e?(k=e.startFrameId,e):null)}function E(e){if(e){let t=ee(p)||hr(e,k,p);return t?(n(8,g=t.introduction),r=t.localeString,S(),n(10,x=!0),t):(console.log("failed to load conversation in loadConversation()"),n(10,x=!1),null)}console.log("Error calling loadConversation(): botConfig arg must be supplied")}var _;function S(){n(6,f=""),n(7,d=""),n(1,({completedRounds:s,replyType:a,replyOptions:i}=fr(p)),s,n(4,a),n(2,i))}function $(e,t){gr({userReplyValues:[e],userReplyIndexes:[t],ending:pr.completed,stats:{},localStorageKey:p}),S()}function O(e){!function(e,t,n){if(void 0===e||void 0===t||void 0===n)return console.log(`rewindConversation(): an argument is undefined: \n      rewoundRoundIndex:${e}\ngetConfigFromRemote:${t}\nlocalStorageKey:${n}`),null;const r=ee(n);r.completedRounds=r.completedRounds.slice(0,e);const s=G(!1,t,n,!1);r.unSpokenFrames=Bn(s.frames),r.completedRounds.forEach((e=>{dr(r,e)})),te(r,n)}(e,!1,p),S()}function T(){try{parseTextInput(f)}catch(e){n(7,d=e),console.log(e.stack)}}function M(e){"Enter"===e.key&&T()}!async function(e,t,r,s){try{const i=v(e,r,t,s);if(i){let e=E(i);n(10,x=!0),await R(),Rs(e.botCosmetics)}else if(!s)throw new J("getBotConfig() failed to acquire a botConfig from localStorage\n          and remote and waitForStartNewConversation prop was false")}catch(e){console.log(`botconfig load error: ${e}`),n(9,m=e),n(12,w=!0)}}(u,p,c,h),_=()=>{!function(){const e=document.querySelectorAll("#conversationHistory ul > li img:first-child, \n                    #currentAsk ul > li img:first-child");e.length>0&&(e.forEach((e=>e.style.marginTop="3rem")),e.forEach((e=>{e.parentElement.parentElement.style.listStyleType="none"})))}()},A().$$.after_update.push(_);return e.$$set=e=>{"propBotConfig"in e&&n(20,u=e.propBotConfig),"propGetConfigFromRemote"in e&&n(21,c=e.propGetConfigFromRemote),"localStorageKey"in e&&n(22,p=e.localStorageKey),"waitForStartNewConversation"in e&&n(0,h=e.waitForStartNewConversation)},[h,s,i,o,a,l,f,d,g,m,x,y,w,b,$,function(e){gr({userReplyValues:e.detail.map((e=>i[e])),userReplyIndexes:e.detail,ending:pr.completed,stats:{},localStorageKey:p}),S()},O,function(e){return e[0]===er[0]&&(e=Qn(1,e)),e},T,M,u,c,p,async function(e=null){try{let t=v(e||u,c,p,h);if(!t)throw new J("startNewConversation() failed to acquire a botConfig from localStorage and remote.");let s=hr(t,k,p);if(!s)throw new J("startNewConversation() failed to acquire conversation objectfrom initConversation()");r=s.localeString,n(8,g=s.introduction),S(),n(10,x=!0),await R(),Rs(s.botCosmetics)}catch(e){console.log(`startNewConversation() botconfig error: ${e}`),n(9,m=e),n(12,w=!0)}},e=>O(e),(e,t)=>$(e,t),function(){l=function(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}(this),n(5,l)},()=>$(i[l],l),function(){f=this.value,n(6,f)},e=>M(e),()=>n(3,o=!0)]}return e.Bot=class extends Q{constructor(e){super(),H(this,e,zs,Cs,o,{propBotConfig:20,propGetConfigFromRemote:21,localStorageKey:22,waitForStartNewConversation:0,startNewConversation:23},null,[-1,-1])}get startNewConversation(){return this.$$.ctx[23]}},Object.defineProperty(e,"__esModule",{value:!0}),e}({});
